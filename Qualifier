{"cells":[{"cell_type":"code","execution_count":null,"metadata":{"id":"CWAsFSKBoPh6"},"outputs":[],"source":["pip install klib"]},{"cell_type":"code","execution_count":1,"metadata":{"executionInfo":{"elapsed":1329,"status":"ok","timestamp":1691019373653,"user":{"displayName":"Musa Muhammad","userId":"05399772858105698249"},"user_tz":-60},"id":"_ZaG4cpQemBk"},"outputs":[],"source":["from sklearn.model_selection import train_test_split\n","from sklearn.linear_model import LinearRegression\n","import klib\n","from sklearn.metrics import mean_squared_error\n","from sklearn.preprocessing import LabelEncoder,MinMaxScaler"]},{"cell_type":"code","execution_count":2,"metadata":{"executionInfo":{"elapsed":32,"status":"ok","timestamp":1691019373657,"user":{"displayName":"Musa Muhammad","userId":"05399772858105698249"},"user_tz":-60},"id":"xGpGga_K_DQY"},"outputs":[],"source":["import numpy as np\n","import pandas as pd"]},{"cell_type":"code","execution_count":3,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":1219,"status":"ok","timestamp":1691019529405,"user":{"displayName":"Musa Muhammad","userId":"05399772858105698249"},"user_tz":-60},"id":"v6zrDH8CBDBE"},"outputs":[],"source":["train = pd.read_csv(\"/content/Train (21).csv\")\n","test = pd.read_csv(\"/content/Test (20).csv\")"]},{"cell_type":"code","execution_count":4,"metadata":{"colab":{"background_save":true,"base_uri":"https://localhost:8080/","height":270},"executionInfo":{"elapsed":66,"status":"ok","timestamp":1691019530033,"user":{"displayName":"Musa Muhammad","userId":"05399772858105698249"},"user_tz":-60},"id":"azkrlI6-wSR6"},"outputs":[{"data":{"text/html":["\n","\n","  \u003cdiv id=\"df-f66c4a1c-e7a4-4e41-ba9e-00f5f46fe3f3\"\u003e\n","    \u003cdiv class=\"colab-df-container\"\u003e\n","      \u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eride_id\u003c/th\u003e\n","      \u003cth\u003eseat_number\u003c/th\u003e\n","      \u003cth\u003epayment_method\u003c/th\u003e\n","      \u003cth\u003epayment_receipt\u003c/th\u003e\n","      \u003cth\u003etravel_date\u003c/th\u003e\n","      \u003cth\u003etravel_time\u003c/th\u003e\n","      \u003cth\u003etravel_from\u003c/th\u003e\n","      \u003cth\u003etravel_to\u003c/th\u003e\n","      \u003cth\u003ecar_type\u003c/th\u003e\n","      \u003cth\u003emax_capacity\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e0\u003c/th\u003e\n","      \u003ctd\u003e1442\u003c/td\u003e\n","      \u003ctd\u003e15A\u003c/td\u003e\n","      \u003ctd\u003eMpesa\u003c/td\u003e\n","      \u003ctd\u003eUZUEHCBUSO\u003c/td\u003e\n","      \u003ctd\u003e17-10-17\u003c/td\u003e\n","      \u003ctd\u003e7:15\u003c/td\u003e\n","      \u003ctd\u003eMigori\u003c/td\u003e\n","      \u003ctd\u003eNairobi\u003c/td\u003e\n","      \u003ctd\u003eBus\u003c/td\u003e\n","      \u003ctd\u003e49\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e1\u003c/th\u003e\n","      \u003ctd\u003e5437\u003c/td\u003e\n","      \u003ctd\u003e14A\u003c/td\u003e\n","      \u003ctd\u003eMpesa\u003c/td\u003e\n","      \u003ctd\u003eTIHLBUSGTE\u003c/td\u003e\n","      \u003ctd\u003e19-11-17\u003c/td\u003e\n","      \u003ctd\u003e7:12\u003c/td\u003e\n","      \u003ctd\u003eMigori\u003c/td\u003e\n","      \u003ctd\u003eNairobi\u003c/td\u003e\n","      \u003ctd\u003eBus\u003c/td\u003e\n","      \u003ctd\u003e49\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e2\u003c/th\u003e\n","      \u003ctd\u003e5710\u003c/td\u003e\n","      \u003ctd\u003e8B\u003c/td\u003e\n","      \u003ctd\u003eMpesa\u003c/td\u003e\n","      \u003ctd\u003eEQX8Q5G19O\u003c/td\u003e\n","      \u003ctd\u003e26-11-17\u003c/td\u003e\n","      \u003ctd\u003e7:05\u003c/td\u003e\n","      \u003ctd\u003eKeroka\u003c/td\u003e\n","      \u003ctd\u003eNairobi\u003c/td\u003e\n","      \u003ctd\u003eBus\u003c/td\u003e\n","      \u003ctd\u003e49\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e3\u003c/th\u003e\n","      \u003ctd\u003e5777\u003c/td\u003e\n","      \u003ctd\u003e19A\u003c/td\u003e\n","      \u003ctd\u003eMpesa\u003c/td\u003e\n","      \u003ctd\u003eSGP18CL0ME\u003c/td\u003e\n","      \u003ctd\u003e27-11-17\u003c/td\u003e\n","      \u003ctd\u003e7:10\u003c/td\u003e\n","      \u003ctd\u003eHoma Bay\u003c/td\u003e\n","      \u003ctd\u003eNairobi\u003c/td\u003e\n","      \u003ctd\u003eBus\u003c/td\u003e\n","      \u003ctd\u003e49\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4\u003c/th\u003e\n","      \u003ctd\u003e5778\u003c/td\u003e\n","      \u003ctd\u003e11A\u003c/td\u003e\n","      \u003ctd\u003eMpesa\u003c/td\u003e\n","      \u003ctd\u003eBM97HFRGL9\u003c/td\u003e\n","      \u003ctd\u003e27-11-17\u003c/td\u003e\n","      \u003ctd\u003e7:12\u003c/td\u003e\n","      \u003ctd\u003eMigori\u003c/td\u003e\n","      \u003ctd\u003eNairobi\u003c/td\u003e\n","      \u003ctd\u003eBus\u003c/td\u003e\n","      \u003ctd\u003e49\u003c/td\u003e\n","    \u003c/tr\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e\n","      \u003cbutton class=\"colab-df-convert\" onclick=\"convertToInteractive('df-f66c4a1c-e7a4-4e41-ba9e-00f5f46fe3f3')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\"\u003e\n","\n","  \u003csvg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\"\u003e\n","    \u003cpath d=\"M0 0h24v24H0V0z\" fill=\"none\"/\u003e\n","    \u003cpath d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/\u003e\u003cpath d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/\u003e\n","  \u003c/svg\u003e\n","      \u003c/button\u003e\n","\n","\n","\n","    \u003cdiv id=\"df-85549a6a-f598-435b-8301-b493c255e547\"\u003e\n","      \u003cbutton class=\"colab-df-quickchart\" onclick=\"quickchart('df-85549a6a-f598-435b-8301-b493c255e547')\"\n","              title=\"Suggest charts.\"\n","              style=\"display:none;\"\u003e\n","\n","\u003csvg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\"\u003e\n","    \u003cg\u003e\n","        \u003cpath d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/\u003e\n","    \u003c/g\u003e\n","\u003c/svg\u003e\n","      \u003c/button\u003e\n","    \u003c/div\u003e\n","\n","\u003cstyle\u003e\n","  .colab-df-quickchart {\n","    background-color: #E8F0FE;\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: #1967D2;\n","    height: 32px;\n","    padding: 0 0 0 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: #E2EBFA;\n","    box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: #174EA6;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","    background-color: #3B4455;\n","    fill: #D2E3FC;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart:hover {\n","    background-color: #434B5C;\n","    box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","    filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","    fill: #FFFFFF;\n","  }\n","\u003c/style\u003e\n","\n","    \u003cscript\u003e\n","      async function quickchart(key) {\n","        const containerElement = document.querySelector('#' + key);\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      }\n","    \u003c/script\u003e\n","\n","      \u003cscript\u003e\n","\n","function displayQuickchartButton(domScope) {\n","  let quickchartButtonEl =\n","    domScope.querySelector('#df-85549a6a-f598-435b-8301-b493c255e547 button.colab-df-quickchart');\n","  quickchartButtonEl.style.display =\n","    google.colab.kernel.accessAllowed ? 'block' : 'none';\n","}\n","\n","        displayQuickchartButton(document);\n","      \u003c/script\u003e\n","      \u003cstyle\u003e\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  \u003c/style\u003e\n","\n","      \u003cscript\u003e\n","        const buttonEl =\n","          document.querySelector('#df-f66c4a1c-e7a4-4e41-ba9e-00f5f46fe3f3 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-f66c4a1c-e7a4-4e41-ba9e-00f5f46fe3f3');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '\u003ca target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb\u003edata table notebook\u003c/a\u003e'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      \u003c/script\u003e\n","    \u003c/div\u003e\n","  \u003c/div\u003e\n"],"text/plain":["   ride_id seat_number payment_method payment_receipt travel_date travel_time  \\\n","0     1442         15A          Mpesa      UZUEHCBUSO    17-10-17        7:15   \n","1     5437         14A          Mpesa      TIHLBUSGTE    19-11-17        7:12   \n","2     5710          8B          Mpesa      EQX8Q5G19O    26-11-17        7:05   \n","3     5777         19A          Mpesa      SGP18CL0ME    27-11-17        7:10   \n","4     5778         11A          Mpesa      BM97HFRGL9    27-11-17        7:12   \n","\n","  travel_from travel_to car_type  max_capacity  \n","0      Migori   Nairobi      Bus            49  \n","1      Migori   Nairobi      Bus            49  \n","2      Keroka   Nairobi      Bus            49  \n","3    Homa Bay   Nairobi      Bus            49  \n","4      Migori   Nairobi      Bus            49  "]},"execution_count":9,"metadata":{},"output_type":"execute_result"}],"source":["train.head()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"BwuaNG3ynmBR"},"outputs":[],"source":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"_yJb08G1nmmN"},"outputs":[],"source":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"SsD9qP1dnm2h"},"outputs":[],"source":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"qzWTUb5NnnKm"},"outputs":[],"source":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"1BzKJqNsnoR4"},"outputs":[],"source":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ZppBD87xnpIc"},"outputs":[],"source":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"bwXA4TkJnqvr"},"outputs":[],"source":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ksabOzO8nrOq"},"outputs":[],"source":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"kcf2AsJVnubi"},"outputs":[],"source":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"RDQ7I-ljnvDx"},"outputs":[],"source":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"-bLujuggnvoC"},"outputs":[],"source":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"jxvDrwRcnwML"},"outputs":[],"source":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"z1lPLvgHnwkW"},"outputs":[],"source":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"D4k3NLz5nxGq"},"outputs":[],"source":[]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":340,"status":"ok","timestamp":1690768411064,"user":{"displayName":"Musa Muhammad","userId":"05399772858105698249"},"user_tz":-60},"id":"CX0pCjCUr6Br","outputId":"a47d3956-dc2a-454f-b050-482a50b66d87"},"outputs":[{"name":"stderr","output_type":"stream","text":["\u003cipython-input-5-2e835de1a62b\u003e:15: FutureWarning: Series.dt.weekofyear and Series.dt.week have been deprecated. Please use Series.dt.isocalendar().week instead.\n","  df_temp['weekofyear'] = df_temp['travel_date'].dt.weekofyear\n","\u003cipython-input-5-2e835de1a62b\u003e:15: FutureWarning: Series.dt.weekofyear and Series.dt.week have been deprecated. Please use Series.dt.isocalendar().week instead.\n","  df_temp['weekofyear'] = df_temp['travel_date'].dt.weekofyear\n"]}],"source":["train[\"travel_date\"]=pd.to_datetime(train[\"travel_date\"])\n","test[\"travel_date\"]=pd.to_datetime(test[\"travel_date\"])\n","def datetime_features(df_temp):\n","    df_temp['hour'] = pd.to_datetime(df_temp['travel_time']).dt.hour\n","    df_temp['minute'] = pd.to_datetime(df_temp['travel_time']).dt.minute\n","    \"\"\"\n","    Datetime feature üretir.\n","    \"\"\"\n","    df_temp['month'] = df_temp['travel_date'].dt.month\n","    df_temp['day'] = df_temp['travel_date'].dt.day\n","    df_temp['year'] = df_temp['travel_date'].dt.year\n","    df_temp['dayofweek'] = df_temp['travel_date'].dt.dayofweek\n","    df_temp['quarter'] = df_temp['travel_date'].dt.quarter\n","    df_temp['dayofmonth'] = df_temp['travel_date'].dt.day\n","    df_temp['weekofyear'] = df_temp['travel_date'].dt.weekofyear\n","    df_temp['is_month_start'] = df_temp.travel_date.dt.is_month_start.astype(np.int8)\n","    df_temp['is_month_end'] = df_temp.travel_date.dt.is_month_end.astype(np.int8)\n","    df_temp['monday'] = df_temp.travel_date.dt.weekday.eq(0).astype(np.uint8)\n","    df_temp['tuesday'] = df_temp.travel_date.dt.weekday.eq(1).astype(np.uint8)\n","    df_temp['wednesday'] = df_temp.travel_date.dt.weekday.eq(2).astype(np.uint8)\n","    df_temp['thursday'] = df_temp.travel_date.dt.weekday.eq(3).astype(np.uint8)\n","    df_temp['friday'] = df_temp.travel_date.dt.weekday.eq(4).astype(np.uint8)\n","    df_temp['saturday'] = df_temp.travel_date.dt.weekday.eq(5).astype(np.uint8)\n","    return df_temp\n","train=datetime_features(train)\n","test=datetime_features(test)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":300},"executionInfo":{"elapsed":1011,"status":"ok","timestamp":1690768411746,"user":{"displayName":"Musa Muhammad","userId":"05399772858105698249"},"user_tz":-60},"id":"l0b_fLRFr-bx","outputId":"4a020188-ff10-4a56-b61f-ef40d13f0101"},"outputs":[{"data":{"text/html":["\n","\n","  \u003cdiv id=\"df-b0f5e1a8-bf3d-4ca9-b08f-bf111395db4e\"\u003e\n","    \u003cdiv class=\"colab-df-container\"\u003e\n","      \u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eride_id\u003c/th\u003e\n","      \u003cth\u003eseat_number\u003c/th\u003e\n","      \u003cth\u003epayment_method\u003c/th\u003e\n","      \u003cth\u003epayment_receipt\u003c/th\u003e\n","      \u003cth\u003etravel_date\u003c/th\u003e\n","      \u003cth\u003etravel_time\u003c/th\u003e\n","      \u003cth\u003etravel_from\u003c/th\u003e\n","      \u003cth\u003etravel_to\u003c/th\u003e\n","      \u003cth\u003ecar_type\u003c/th\u003e\n","      \u003cth\u003emax_capacity\u003c/th\u003e\n","      \u003cth\u003e...\u003c/th\u003e\n","      \u003cth\u003edayofmonth\u003c/th\u003e\n","      \u003cth\u003eweekofyear\u003c/th\u003e\n","      \u003cth\u003eis_month_start\u003c/th\u003e\n","      \u003cth\u003eis_month_end\u003c/th\u003e\n","      \u003cth\u003emonday\u003c/th\u003e\n","      \u003cth\u003etuesday\u003c/th\u003e\n","      \u003cth\u003ewednesday\u003c/th\u003e\n","      \u003cth\u003ethursday\u003c/th\u003e\n","      \u003cth\u003efriday\u003c/th\u003e\n","      \u003cth\u003esaturday\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e0\u003c/th\u003e\n","      \u003ctd\u003e1442\u003c/td\u003e\n","      \u003ctd\u003e15A\u003c/td\u003e\n","      \u003ctd\u003eMpesa\u003c/td\u003e\n","      \u003ctd\u003eUZUEHCBUSO\u003c/td\u003e\n","      \u003ctd\u003e2017-10-17\u003c/td\u003e\n","      \u003ctd\u003e7:15\u003c/td\u003e\n","      \u003ctd\u003eMigori\u003c/td\u003e\n","      \u003ctd\u003eNairobi\u003c/td\u003e\n","      \u003ctd\u003eBus\u003c/td\u003e\n","      \u003ctd\u003e49\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e17\u003c/td\u003e\n","      \u003ctd\u003e42\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e1\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e1\u003c/th\u003e\n","      \u003ctd\u003e5437\u003c/td\u003e\n","      \u003ctd\u003e14A\u003c/td\u003e\n","      \u003ctd\u003eMpesa\u003c/td\u003e\n","      \u003ctd\u003eTIHLBUSGTE\u003c/td\u003e\n","      \u003ctd\u003e2017-11-19\u003c/td\u003e\n","      \u003ctd\u003e7:12\u003c/td\u003e\n","      \u003ctd\u003eMigori\u003c/td\u003e\n","      \u003ctd\u003eNairobi\u003c/td\u003e\n","      \u003ctd\u003eBus\u003c/td\u003e\n","      \u003ctd\u003e49\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e19\u003c/td\u003e\n","      \u003ctd\u003e46\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e2\u003c/th\u003e\n","      \u003ctd\u003e5710\u003c/td\u003e\n","      \u003ctd\u003e8B\u003c/td\u003e\n","      \u003ctd\u003eMpesa\u003c/td\u003e\n","      \u003ctd\u003eEQX8Q5G19O\u003c/td\u003e\n","      \u003ctd\u003e2017-11-26\u003c/td\u003e\n","      \u003ctd\u003e7:05\u003c/td\u003e\n","      \u003ctd\u003eKeroka\u003c/td\u003e\n","      \u003ctd\u003eNairobi\u003c/td\u003e\n","      \u003ctd\u003eBus\u003c/td\u003e\n","      \u003ctd\u003e49\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e26\u003c/td\u003e\n","      \u003ctd\u003e47\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e3\u003c/th\u003e\n","      \u003ctd\u003e5777\u003c/td\u003e\n","      \u003ctd\u003e19A\u003c/td\u003e\n","      \u003ctd\u003eMpesa\u003c/td\u003e\n","      \u003ctd\u003eSGP18CL0ME\u003c/td\u003e\n","      \u003ctd\u003e2017-11-27\u003c/td\u003e\n","      \u003ctd\u003e7:10\u003c/td\u003e\n","      \u003ctd\u003eHoma Bay\u003c/td\u003e\n","      \u003ctd\u003eNairobi\u003c/td\u003e\n","      \u003ctd\u003eBus\u003c/td\u003e\n","      \u003ctd\u003e49\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e27\u003c/td\u003e\n","      \u003ctd\u003e48\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e1\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4\u003c/th\u003e\n","      \u003ctd\u003e5778\u003c/td\u003e\n","      \u003ctd\u003e11A\u003c/td\u003e\n","      \u003ctd\u003eMpesa\u003c/td\u003e\n","      \u003ctd\u003eBM97HFRGL9\u003c/td\u003e\n","      \u003ctd\u003e2017-11-27\u003c/td\u003e\n","      \u003ctd\u003e7:12\u003c/td\u003e\n","      \u003ctd\u003eMigori\u003c/td\u003e\n","      \u003ctd\u003eNairobi\u003c/td\u003e\n","      \u003ctd\u003eBus\u003c/td\u003e\n","      \u003ctd\u003e49\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e27\u003c/td\u003e\n","      \u003ctd\u003e48\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e1\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","    \u003c/tr\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003cp\u003e5 rows × 27 columns\u003c/p\u003e\n","\u003c/div\u003e\n","      \u003cbutton class=\"colab-df-convert\" onclick=\"convertToInteractive('df-b0f5e1a8-bf3d-4ca9-b08f-bf111395db4e')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\"\u003e\n","\n","  \u003csvg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\"\u003e\n","    \u003cpath d=\"M0 0h24v24H0V0z\" fill=\"none\"/\u003e\n","    \u003cpath d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/\u003e\u003cpath d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/\u003e\n","  \u003c/svg\u003e\n","      \u003c/button\u003e\n","\n","\n","\n","    \u003cdiv id=\"df-1bb86310-c9da-40ce-b871-804fc8409339\"\u003e\n","      \u003cbutton class=\"colab-df-quickchart\" onclick=\"quickchart('df-1bb86310-c9da-40ce-b871-804fc8409339')\"\n","              title=\"Suggest charts.\"\n","              style=\"display:none;\"\u003e\n","\n","\u003csvg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\"\u003e\n","    \u003cg\u003e\n","        \u003cpath d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/\u003e\n","    \u003c/g\u003e\n","\u003c/svg\u003e\n","      \u003c/button\u003e\n","    \u003c/div\u003e\n","\n","\u003cstyle\u003e\n","  .colab-df-quickchart {\n","    background-color: #E8F0FE;\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: #1967D2;\n","    height: 32px;\n","    padding: 0 0 0 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: #E2EBFA;\n","    box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: #174EA6;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","    background-color: #3B4455;\n","    fill: #D2E3FC;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart:hover {\n","    background-color: #434B5C;\n","    box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","    filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","    fill: #FFFFFF;\n","  }\n","\u003c/style\u003e\n","\n","    \u003cscript\u003e\n","      async function quickchart(key) {\n","        const containerElement = document.querySelector('#' + key);\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      }\n","    \u003c/script\u003e\n","\n","      \u003cscript\u003e\n","\n","function displayQuickchartButton(domScope) {\n","  let quickchartButtonEl =\n","    domScope.querySelector('#df-1bb86310-c9da-40ce-b871-804fc8409339 button.colab-df-quickchart');\n","  quickchartButtonEl.style.display =\n","    google.colab.kernel.accessAllowed ? 'block' : 'none';\n","}\n","\n","        displayQuickchartButton(document);\n","      \u003c/script\u003e\n","      \u003cstyle\u003e\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  \u003c/style\u003e\n","\n","      \u003cscript\u003e\n","        const buttonEl =\n","          document.querySelector('#df-b0f5e1a8-bf3d-4ca9-b08f-bf111395db4e button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-b0f5e1a8-bf3d-4ca9-b08f-bf111395db4e');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '\u003ca target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb\u003edata table notebook\u003c/a\u003e'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      \u003c/script\u003e\n","    \u003c/div\u003e\n","  \u003c/div\u003e\n"],"text/plain":["   ride_id seat_number payment_method payment_receipt travel_date travel_time  \\\n","0     1442         15A          Mpesa      UZUEHCBUSO  2017-10-17        7:15   \n","1     5437         14A          Mpesa      TIHLBUSGTE  2017-11-19        7:12   \n","2     5710          8B          Mpesa      EQX8Q5G19O  2017-11-26        7:05   \n","3     5777         19A          Mpesa      SGP18CL0ME  2017-11-27        7:10   \n","4     5778         11A          Mpesa      BM97HFRGL9  2017-11-27        7:12   \n","\n","  travel_from travel_to car_type  max_capacity  ...  dayofmonth  weekofyear  \\\n","0      Migori   Nairobi      Bus            49  ...          17          42   \n","1      Migori   Nairobi      Bus            49  ...          19          46   \n","2      Keroka   Nairobi      Bus            49  ...          26          47   \n","3    Homa Bay   Nairobi      Bus            49  ...          27          48   \n","4      Migori   Nairobi      Bus            49  ...          27          48   \n","\n","   is_month_start  is_month_end  monday  tuesday  wednesday  thursday  friday  \\\n","0               0             0       0        1          0         0       0   \n","1               0             0       0        0          0         0       0   \n","2               0             0       0        0          0         0       0   \n","3               0             0       1        0          0         0       0   \n","4               0             0       1        0          0         0       0   \n","\n","   saturday  \n","0         0  \n","1         0  \n","2         0  \n","3         0  \n","4         0  \n","\n","[5 rows x 27 columns]"]},"execution_count":6,"metadata":{},"output_type":"execute_result"}],"source":["train.head()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"CnyacATPr-pC"},"outputs":[],"source":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"A1yJBO-VdmVQ"},"outputs":[],"source":["train[\"seat_number_numeric\"] = train[\"seat_number\"].str.extract(\"(\\d+)\")\n","train[\"seat_number_letter\"] = train[\"seat_number\"].str.extract(\"([A-Za-z]+)\")\n","\n","cat = [\"payment_method\", \"car_type\",'travel_from','travel_to','payment_receipt','travel_time','seat_number_letter']\n","label = LabelEncoder()\n","train[cat] = label.fit_transform(cat)\n","test[cat] = label.fit_transform(cat)\n","\n","train[\"seat_number_numeric\"] = train[\"seat_number_numeric\"].astype(int)\n","\n","target = train[\"seat_number_numeric\"]\n","train = train.drop(columns=[\"ride_id\", \"seat_number\",'seat_number_numeric','travel_date'])\n","test = test.drop(columns=[\"ride_id\",'travel_date'])"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"f1Zy-7-QqkES"},"outputs":[],"source":["from keras.layers import Input, Dense\n","from keras.models import Model"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true,"base_uri":"https://localhost:8080/"},"id":"9WCgCxwMpssn","outputId":"5829d895-ac25-4a65-e524-57dbbd783256"},"outputs":[{"name":"stdout","output_type":"stream","text":["Epoch 1/100\n","3228/3228 [==============================] - 8s 2ms/step - loss: 38.4873\n","Epoch 2/100\n","3228/3228 [==============================] - 6s 2ms/step - loss: 34.7379\n","Epoch 3/100\n","3228/3228 [==============================] - 6s 2ms/step - loss: 34.3194\n","Epoch 4/100\n","3228/3228 [==============================] - 6s 2ms/step - loss: 33.9208\n","Epoch 5/100\n","3228/3228 [==============================] - 5s 2ms/step - loss: 33.8972\n","Epoch 6/100\n","3228/3228 [==============================] - 6s 2ms/step - loss: 33.6905\n","Epoch 7/100\n","3228/3228 [==============================] - 5s 2ms/step - loss: 33.6044\n","Epoch 8/100\n","3228/3228 [==============================] - 7s 2ms/step - loss: 33.5475\n","Epoch 9/100\n","3228/3228 [==============================] - 5s 2ms/step - loss: 33.5212\n","Epoch 10/100\n","3228/3228 [==============================] - 8s 3ms/step - loss: 33.4690\n","Epoch 11/100\n","3228/3228 [==============================] - 6s 2ms/step - loss: 33.4385\n","Epoch 12/100\n","3228/3228 [==============================] - 7s 2ms/step - loss: 33.4388\n","Epoch 13/100\n","3228/3228 [==============================] - 6s 2ms/step - loss: 33.4121\n","Epoch 14/100\n","3228/3228 [==============================] - 6s 2ms/step - loss: 33.3796\n","Epoch 15/100\n","3228/3228 [==============================] - 7s 2ms/step - loss: 33.4066\n","Epoch 16/100\n","3228/3228 [==============================] - 7s 2ms/step - loss: 33.3797\n","Epoch 17/100\n","3228/3228 [==============================] - 6s 2ms/step - loss: 33.3547\n","Epoch 18/100\n","3228/3228 [==============================] - 9s 3ms/step - loss: 33.3729\n","Epoch 19/100\n","3228/3228 [==============================] - 7s 2ms/step - loss: 33.3452\n","Epoch 20/100\n","3228/3228 [==============================] - 6s 2ms/step - loss: 33.3068\n","Epoch 21/100\n","3228/3228 [==============================] - 6s 2ms/step - loss: 33.3269\n","Epoch 22/100\n","3228/3228 [==============================] - 7s 2ms/step - loss: 33.3147\n","Epoch 23/100\n","3228/3228 [==============================] - 6s 2ms/step - loss: 33.2925\n","Epoch 24/100\n","3228/3228 [==============================] - 6s 2ms/step - loss: 33.3175\n","Epoch 25/100\n","3228/3228 [==============================] - 6s 2ms/step - loss: 33.3083\n","Epoch 26/100\n","3228/3228 [==============================] - 6s 2ms/step - loss: 33.2827\n","Epoch 27/100\n","3228/3228 [==============================] - 6s 2ms/step - loss: 33.2814\n","Epoch 28/100\n","3228/3228 [==============================] - 6s 2ms/step - loss: 33.2938\n","Epoch 29/100\n","3228/3228 [==============================] - 6s 2ms/step - loss: 33.2642\n","Epoch 30/100\n","3228/3228 [==============================] - 8s 3ms/step - loss: 33.2887\n","Epoch 31/100\n","3228/3228 [==============================] - 6s 2ms/step - loss: 33.2711\n","Epoch 32/100\n","3228/3228 [==============================] - 7s 2ms/step - loss: 33.2695\n","Epoch 33/100\n","3228/3228 [==============================] - 6s 2ms/step - loss: 33.2624\n","Epoch 34/100\n","3228/3228 [==============================] - 7s 2ms/step - loss: 33.2616\n","Epoch 35/100\n","3228/3228 [==============================] - 6s 2ms/step - loss: 33.2597\n","Epoch 36/100\n","3228/3228 [==============================] - 7s 2ms/step - loss: 33.2994\n","Epoch 37/100\n","3228/3228 [==============================] - 6s 2ms/step - loss: 33.2570\n","Epoch 38/100\n","3228/3228 [==============================] - 6s 2ms/step - loss: 33.2608\n","Epoch 39/100\n","3228/3228 [==============================] - 7s 2ms/step - loss: 33.2443\n","Epoch 40/100\n","3228/3228 [==============================] - 8s 2ms/step - loss: 33.2288\n","Epoch 41/100\n","3228/3228 [==============================] - 6s 2ms/step - loss: 33.2815\n","Epoch 42/100\n","3228/3228 [==============================] - 7s 2ms/step - loss: 33.2607\n","Epoch 43/100\n","3228/3228 [==============================] - 6s 2ms/step - loss: 33.2561\n","Epoch 44/100\n","3228/3228 [==============================] - 7s 2ms/step - loss: 33.2474\n","Epoch 45/100\n","3228/3228 [==============================] - 6s 2ms/step - loss: 33.2361\n","Epoch 46/100\n","3228/3228 [==============================] - 7s 2ms/step - loss: 33.2555\n","Epoch 47/100\n","3228/3228 [==============================] - 6s 2ms/step - loss: 33.2582\n","Epoch 48/100\n","3228/3228 [==============================] - 7s 2ms/step - loss: 33.2062\n","Epoch 49/100\n","3228/3228 [==============================] - 6s 2ms/step - loss: 33.2276\n","Epoch 50/100\n","3228/3228 [==============================] - 7s 2ms/step - loss: 33.2310\n","Epoch 51/100\n","3228/3228 [==============================] - 6s 2ms/step - loss: 33.2035\n","Epoch 52/100\n","3228/3228 [==============================] - 6s 2ms/step - loss: 33.2070\n","Epoch 53/100\n","3228/3228 [==============================] - 7s 2ms/step - loss: 33.2445\n","Epoch 54/100\n","3228/3228 [==============================] - 6s 2ms/step - loss: 33.2106\n","Epoch 55/100\n","3228/3228 [==============================] - 6s 2ms/step - loss: 33.1987\n","Epoch 56/100\n","3228/3228 [==============================] - 7s 2ms/step - loss: 33.1933\n","Epoch 57/100\n","3228/3228 [==============================] - 6s 2ms/step - loss: 33.2308\n","Epoch 58/100\n","3228/3228 [==============================] - 7s 2ms/step - loss: 33.2431\n","Epoch 59/100\n","3228/3228 [==============================] - 6s 2ms/step - loss: 33.2317\n","Epoch 60/100\n","3228/3228 [==============================] - 7s 2ms/step - loss: 33.2040\n","Epoch 61/100\n","3228/3228 [==============================] - 6s 2ms/step - loss: 33.1931\n","Epoch 62/100\n","3228/3228 [==============================] - 7s 2ms/step - loss: 33.1941\n","Epoch 63/100\n","3228/3228 [==============================] - 6s 2ms/step - loss: 33.2187\n","Epoch 64/100\n","3228/3228 [==============================] - 7s 2ms/step - loss: 33.2032\n","Epoch 65/100\n","3228/3228 [==============================] - 6s 2ms/step - loss: 33.2043\n","Epoch 66/100\n","3228/3228 [==============================] - 7s 2ms/step - loss: 33.2413\n","Epoch 67/100\n","3228/3228 [==============================] - 6s 2ms/step - loss: 33.1904\n","Epoch 68/100\n","3228/3228 [==============================] - 7s 2ms/step - loss: 33.1740\n","Epoch 69/100\n","3228/3228 [==============================] - 6s 2ms/step - loss: 33.2118\n","Epoch 70/100\n","3228/3228 [==============================] - 7s 2ms/step - loss: 33.2072\n","Epoch 71/100\n","3228/3228 [==============================] - 6s 2ms/step - loss: 33.1784\n","Epoch 72/100\n","3228/3228 [==============================] - 7s 2ms/step - loss: 33.1741\n","Epoch 73/100\n","3228/3228 [==============================] - 6s 2ms/step - loss: 33.1717\n","Epoch 74/100\n","3228/3228 [==============================] - 7s 2ms/step - loss: 33.1989\n","Epoch 75/100\n","3228/3228 [==============================] - 6s 2ms/step - loss: 33.1693\n","Epoch 76/100\n","3228/3228 [==============================] - 6s 2ms/step - loss: 33.1936\n","Epoch 77/100\n","3228/3228 [==============================] - 6s 2ms/step - loss: 33.1766\n","Epoch 78/100\n","3228/3228 [==============================] - 7s 2ms/step - loss: 33.1809\n","Epoch 79/100\n","3228/3228 [==============================] - 6s 2ms/step - loss: 33.1610\n","Epoch 80/100\n","3228/3228 [==============================] - 7s 2ms/step - loss: 33.1860\n","Epoch 81/100\n","3228/3228 [==============================] - 6s 2ms/step - loss: 33.1310\n","Epoch 82/100\n","3228/3228 [==============================] - 7s 2ms/step - loss: 33.1784\n","Epoch 83/100\n","3228/3228 [==============================] - 6s 2ms/step - loss: 33.1980\n","Epoch 84/100\n","3228/3228 [==============================] - 7s 2ms/step - loss: 33.1787\n","Epoch 85/100\n","3228/3228 [==============================] - 6s 2ms/step - loss: 33.1767\n","Epoch 86/100\n","3228/3228 [==============================] - 7s 2ms/step - loss: 33.1832\n","Epoch 87/100\n","3228/3228 [==============================] - 6s 2ms/step - loss: 33.1664\n","Epoch 88/100\n","3228/3228 [==============================] - 6s 2ms/step - loss: 33.1574\n","Epoch 89/100\n","3228/3228 [==============================] - 6s 2ms/step - loss: 33.1959\n","Epoch 90/100\n","3228/3228 [==============================] - 6s 2ms/step - loss: 33.2182\n","Epoch 91/100\n","3228/3228 [==============================] - 6s 2ms/step - loss: 33.1468\n","Epoch 92/100\n","3228/3228 [==============================] - 6s 2ms/step - loss: 33.1585\n","Epoch 93/100\n","3228/3228 [==============================] - 6s 2ms/step - loss: 33.1501\n","Epoch 94/100\n","3228/3228 [==============================] - 6s 2ms/step - loss: 33.1690\n","Epoch 95/100\n","3228/3228 [==============================] - 7s 2ms/step - loss: 33.1581\n","Epoch 96/100\n","3228/3228 [==============================] - 6s 2ms/step - loss: 33.1673\n","Epoch 97/100\n","3228/3228 [==============================] - 6s 2ms/step - loss: 33.1621\n","Epoch 98/100\n","3228/3228 [==============================] - 6s 2ms/step - loss: 33.1496\n","Epoch 99/100\n","3228/3228 [==============================] - 6s 2ms/step - loss: 33.1666\n","Epoch 100/100\n","3228/3228 [==============================] - 6s 2ms/step - loss: 33.1683\n","1614/1614 [==============================] - 2s 1ms/step\n","28/28 [==============================] - 0s 1ms/step\n"]}],"source":["encoding_dim = 10\n","input_layer = Input(shape=(train.shape[1],))\n","\n","\n","encoded = Dense(226, activation='relu')(input_layer)\n","encoded = Dense(encoding_dim, activation='relu')(encoded)\n","\n","decoded = Dense(226, activation='relu')(encoded)\n","decoded = Dense(train.shape[1], activation='linear')(decoded)\n","\n","autoencoder = Model(input_layer, decoded)\n","\n","\n","autoencoder.compile(optimizer='adam', loss='mse')\n","\n","autoencoder.fit(train, target, epochs=100, batch_size=16, shuffle=True)\n","\n","encoder = Model(input_layer, encoded)\n","train = encoder.predict(train)\n","test = encoder.predict(test)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":21,"status":"ok","timestamp":1690768596456,"user":{"displayName":"Musa Muhammad","userId":"05399772858105698249"},"user_tz":-60},"id":"z6Fk48SqUTX_","outputId":"6329a356-9c68-4ec4-e4bc-ae71956e9903"},"outputs":[{"data":{"text/plain":["Index(['payment_method', 'payment_receipt', 'travel_time', 'travel_from',\n","       'travel_to', 'car_type', 'max_capacity', 'hour', 'minute', 'month',\n","       'day', 'year', 'dayofweek', 'quarter', 'dayofmonth', 'weekofyear',\n","       'is_month_start', 'is_month_end', 'monday', 'tuesday', 'wednesday',\n","       'thursday', 'friday', 'saturday', 'seat_number_letter'],\n","      dtype='object')"]},"execution_count":13,"metadata":{},"output_type":"execute_result"}],"source":["train.columns"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"hNZmNaxTdmtX"},"outputs":[],"source":["trainColum = ['payment_method', 'travel_time', 'car_type', 'max_capacity', 'quarter',]\n","train = train[trainColum]\n","test = test[trainColum]"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":149,"status":"ok","timestamp":1690513101710,"user":{"displayName":"Musa Muhammad","userId":"05399772858105698249"},"user_tz":-60},"id":"15NwgePCtkNm","outputId":"7768f896-10ac-43e0-e67b-f1abe52ab87b"},"outputs":[{"data":{"text/plain":["array([ True,  True,  True,  True,  True])"]},"execution_count":78,"metadata":{},"output_type":"execute_result"}],"source":["train.columns == test.columns"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"ZxKq064-v-bw"},"outputs":[],"source":["scale = MinMaxScaler()\n","features = scale.fit_transform(train)\n","test = scale.transform(test)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"cGI3TK2QuJbu"},"outputs":[],"source":["x_train, x_train_test, y_train, y_test = train_test_split(features,target, test_size=0.1, random_state=43)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"bJw0XbcSwfFc"},"outputs":[],"source":["pip install optuna"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true,"base_uri":"https://localhost:8080/","output_embedded_package_id":"1hlnXLp7ynbAmVL9GqcC-x1NWDdPeceIw"},"executionInfo":{"elapsed":114916,"status":"ok","timestamp":1690513221133,"user":{"displayName":"Musa Muhammad","userId":"05399772858105698249"},"user_tz":-60},"id":"WVWrFCovwDPH","outputId":"25d8c5ff-70eb-4f15-aee6-1c2c13ef5357"},"outputs":[],"source":["import optuna\n","from sklearn.metrics import mean_squared_error, mean_absolute_error\n","import lightgbm as lgb\n","\n","train_data = lgb.Dataset(x_train, label=y_train)\n","val_data = lgb.Dataset(x_train_test, label=y_test)\n","\n","def objective(trial):\n","    params = {\n","\n","\n","        'objective': 'regression',\n","        'metric': 'mean_squared_error',\n","        'boosting_type': 'gbdt',\n","        'lambda_l1': trial.suggest_loguniform('lambda_l1', 1e-8, 10.0),\n","        'lambda_l2': trial.suggest_loguniform('lambda_l2', 1e-8, 10.0),\n","        'num_leaves': trial.suggest_int('num_leaves', 2, 500),\n","        'feature_fraction': trial.suggest_uniform('feature_fraction', 0.4, 1.0),\n","        'bagging_fraction': trial.suggest_uniform('bagging_fraction', 0.4, 1.0),\n","        'bagging_freq': trial.suggest_int('bagging_freq', 1, 500),\n","        'min_child_samples': trial.suggest_int('min_child_samples', 5, 200),\n","        'feature_pre_filter': False,\n","        'learning_rate': trial.suggest_loguniform('learning_rate', 0.01, 0.3),\n","        'max_depth': trial.suggest_int('max_depth', 3, 10),\n","        'min_data_in_leaf': trial.suggest_int('min_data_in_leaf', 10, 500),\n","        'subsample': trial.suggest_uniform('subsample', 0.6, 1.0),\n","        'colsample_bytree': trial.suggest_uniform('colsample_bytree', 0.6, 1.0),\n","        'subsample_freq': trial.suggest_int('subsample_freq', 1, 500)\n","    }\n","\n","    model = lgb.train(\n","        params,\n","        train_data,\n","        valid_sets=[train_data, val_data],\n","        early_stopping_rounds=200,\n","        verbose_eval=False\n","    )\n","\n","    y_pred = model.predict(x_train_test)\n","    score = mean_squared_error(y_test, y_pred)\n","\n","    return score\n","\n","study = optuna.create_study(direction='minimize')\n","study.optimize(objective, n_trials=200)\n","\n","best_params = study.best_params\n","best_score = study.best_value\n","\n","final_params = {\n","    'objective': 'regression',\n","    'metric': 'mean_squared_error',\n","    'verbosity': -1,\n","    'boosting_type': 'gbdt',\n","    **best_params\n","}\n","\n","final_model = lgb.train(final_params, train_data, valid_sets=[train_data, val_data], early_stopping_rounds=200, verbose_eval=False)\n","test_pred = final_model.predict(test)\n","\n","print('Best Parameters:', best_params)\n","print('Best Mean Squared Error:', best_score)\n","#print('Test Predictions:', test_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":14529,"status":"ok","timestamp":1690503578559,"user":{"displayName":"Musa Muhammad","userId":"05399772858105698249"},"user_tz":-60},"id":"zRutDQDX3QJ1","outputId":"dbcacf7c-cdc2-46b4-adc8-7e159d450a7a"},"outputs":[{"name":"stdout","output_type":"stream","text":["Collecting catboost\n","  Downloading catboost-1.2-cp310-cp310-manylinux2014_x86_64.whl (98.6 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m98.6/98.6 MB\u001b[0m \u001b[31m3.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: graphviz in /usr/local/lib/python3.10/dist-packages (from catboost) (0.20.1)\n","Requirement already satisfied: matplotlib in /usr/local/lib/python3.10/dist-packages (from catboost) (3.7.1)\n","Requirement already satisfied: numpy\u003e=1.16.0 in /usr/local/lib/python3.10/dist-packages (from catboost) (1.22.4)\n","Requirement already satisfied: pandas\u003e=0.24 in /usr/local/lib/python3.10/dist-packages (from catboost) (1.5.3)\n","Requirement already satisfied: scipy in /usr/local/lib/python3.10/dist-packages (from catboost) (1.10.1)\n","Requirement already satisfied: plotly in /usr/local/lib/python3.10/dist-packages (from catboost) (5.13.1)\n","Requirement already satisfied: six in /usr/local/lib/python3.10/dist-packages (from catboost) (1.16.0)\n","Requirement already satisfied: python-dateutil\u003e=2.8.1 in /usr/local/lib/python3.10/dist-packages (from pandas\u003e=0.24-\u003ecatboost) (2.8.2)\n","Requirement already satisfied: pytz\u003e=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas\u003e=0.24-\u003ecatboost) (2022.7.1)\n","Requirement already satisfied: contourpy\u003e=1.0.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib-\u003ecatboost) (1.1.0)\n","Requirement already satisfied: cycler\u003e=0.10 in /usr/local/lib/python3.10/dist-packages (from matplotlib-\u003ecatboost) (0.11.0)\n","Requirement already satisfied: fonttools\u003e=4.22.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib-\u003ecatboost) (4.41.1)\n","Requirement already satisfied: kiwisolver\u003e=1.0.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib-\u003ecatboost) (1.4.4)\n","Requirement already satisfied: packaging\u003e=20.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib-\u003ecatboost) (23.1)\n","Requirement already satisfied: pillow\u003e=6.2.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib-\u003ecatboost) (9.4.0)\n","Requirement already satisfied: pyparsing\u003e=2.3.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib-\u003ecatboost) (3.1.0)\n","Requirement already satisfied: tenacity\u003e=6.2.0 in /usr/local/lib/python3.10/dist-packages (from plotly-\u003ecatboost) (8.2.2)\n","Installing collected packages: catboost\n","Successfully installed catboost-1.2\n"]}],"source":["pip install catboost"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"8fXHnT9k3Xne"},"outputs":[],"source":["import catboost as cat"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":758892,"status":"ok","timestamp":1690504462017,"user":{"displayName":"Musa Muhammad","userId":"05399772858105698249"},"user_tz":-60},"id":"BJc06ifL3EwB","outputId":"ef3d124d-5f71-4ab3-96bd-8b460b7f5ab5"},"outputs":[{"name":"stderr","output_type":"stream","text":["[I 2023-07-28 00:21:42,620] A new study created in memory with name: no-name-08c09311-482d-41fd-985f-ac99519c5330\n","[I 2023-07-28 00:21:48,736] Trial 0 finished with value: -32.07172231661442 and parameters: {'learning_rate': 0.08983531007100919, 'depth': 5, 'l2_leaf_reg': 8.042275311185824, 'bagging_temperature': 1.5478347093665379, 'border_count': 162, 'iterations': 679, 'random_strength': 1.5949438068675506, 'grow_policy': 'Lossguide', 'colsample_bylevel': 0.5899230094875939}. Best is trial 0 with value: -32.07172231661442.\n","[I 2023-07-28 00:21:53,463] Trial 1 finished with value: -32.081449917799446 and parameters: {'learning_rate': 0.05967552003236476, 'depth': 8, 'l2_leaf_reg': 9.364830037075476, 'bagging_temperature': 6.691622207455437, 'border_count': 167, 'iterations': 727, 'random_strength': 6.174504908026213, 'grow_policy': 'Lossguide', 'colsample_bylevel': 0.8478959469238978}. Best is trial 0 with value: -32.07172231661442.\n","[I 2023-07-28 00:21:55,093] Trial 2 finished with value: -32.58758920019984 and parameters: {'learning_rate': 0.09616841758666184, 'depth': 9, 'l2_leaf_reg': 3.7594288805263707, 'bagging_temperature': 1.0273171713613538, 'border_count': 205, 'iterations': 342, 'random_strength': 1.095825526996085, 'grow_policy': 'Lossguide', 'colsample_bylevel': 0.10197802464882086}. Best is trial 0 with value: -32.07172231661442.\n","[I 2023-07-28 00:22:04,237] Trial 3 finished with value: -32.07094875981084 and parameters: {'learning_rate': 0.022896171221129837, 'depth': 5, 'l2_leaf_reg': 0.41392385648213725, 'bagging_temperature': 8.865249026393977, 'border_count': 190, 'iterations': 715, 'random_strength': 4.013082265478251, 'grow_policy': 'Lossguide', 'colsample_bylevel': 0.7011703478061951}. Best is trial 3 with value: -32.07094875981084.\n","[I 2023-07-28 00:22:05,332] Trial 4 finished with value: -32.44847480690412 and parameters: {'learning_rate': 0.04975132261401837, 'depth': 9, 'l2_leaf_reg': 7.823042506088451, 'bagging_temperature': 5.151154999618414, 'border_count': 192, 'iterations': 202, 'random_strength': 3.4901317162997447, 'grow_policy': 'SymmetricTree', 'colsample_bylevel': 0.3657499606987389}. Best is trial 3 with value: -32.07094875981084.\n","[I 2023-07-28 00:22:08,838] Trial 5 finished with value: -32.07393390037749 and parameters: {'learning_rate': 0.0866764062017495, 'depth': 5, 'l2_leaf_reg': 6.874268646641563, 'bagging_temperature': 0.26606085280186154, 'border_count': 128, 'iterations': 734, 'random_strength': 4.550859343989769, 'grow_policy': 'Depthwise', 'colsample_bylevel': 0.6565904502449772}. Best is trial 3 with value: -32.07094875981084.\n","[I 2023-07-28 00:22:14,721] Trial 6 finished with value: -32.093266487508416 and parameters: {'learning_rate': 0.07116865254782831, 'depth': 8, 'l2_leaf_reg': 2.0459266643178236, 'bagging_temperature': 5.463409988185457, 'border_count': 156, 'iterations': 507, 'random_strength': 4.761422113332143, 'grow_policy': 'Depthwise', 'colsample_bylevel': 0.6308568366883626}. Best is trial 3 with value: -32.07094875981084.\n","[I 2023-07-28 00:22:18,063] Trial 7 finished with value: -32.065779624397976 and parameters: {'learning_rate': 0.0878886988651016, 'depth': 8, 'l2_leaf_reg': 1.8795514647473277, 'bagging_temperature': 8.201423078740525, 'border_count': 145, 'iterations': 931, 'random_strength': 3.332943914230348, 'grow_policy': 'Lossguide', 'colsample_bylevel': 0.6568368563288229}. Best is trial 7 with value: -32.065779624397976.\n","[I 2023-07-28 00:22:18,817] Trial 8 finished with value: -32.71507279224245 and parameters: {'learning_rate': 0.08734449512505776, 'depth': 6, 'l2_leaf_reg': 6.339902084216185, 'bagging_temperature': 7.416882102407072, 'border_count': 177, 'iterations': 150, 'random_strength': 8.201947491258833, 'grow_policy': 'SymmetricTree', 'colsample_bylevel': 0.15441192469582538}. Best is trial 7 with value: -32.065779624397976.\n","[I 2023-07-28 00:22:22,233] Trial 9 finished with value: -32.322270126811354 and parameters: {'learning_rate': 0.0411287720054276, 'depth': 5, 'l2_leaf_reg': 6.766411361557241, 'bagging_temperature': 7.130282060988787, 'border_count': 82, 'iterations': 973, 'random_strength': 1.3756511478871194, 'grow_policy': 'SymmetricTree', 'colsample_bylevel': 0.16448815191793595}. Best is trial 7 with value: -32.065779624397976.\n","[I 2023-07-28 00:22:28,187] Trial 10 finished with value: -32.07414936793964 and parameters: {'learning_rate': 0.07353923439662553, 'depth': 10, 'l2_leaf_reg': 4.069879332701632, 'bagging_temperature': 9.92300062470781, 'border_count': 242, 'iterations': 972, 'random_strength': 7.363932434991279, 'grow_policy': 'Lossguide', 'colsample_bylevel': 0.9016658692824362}. Best is trial 7 with value: -32.065779624397976.\n","[I 2023-07-28 00:22:39,865] Trial 11 finished with value: -32.21029598867215 and parameters: {'learning_rate': 0.0153369889532126, 'depth': 7, 'l2_leaf_reg': 0.18614120721806215, 'bagging_temperature': 9.91198498936389, 'border_count': 107, 'iterations': 843, 'random_strength': 9.735243248454857, 'grow_policy': 'Lossguide', 'colsample_bylevel': 0.7960211030469276}. Best is trial 7 with value: -32.065779624397976.\n","[I 2023-07-28 00:22:45,405] Trial 12 finished with value: -32.102308722248395 and parameters: {'learning_rate': 0.02590080411732206, 'depth': 4, 'l2_leaf_reg': 0.1993539130098121, 'bagging_temperature': 8.564252868939667, 'border_count': 36, 'iterations': 529, 'random_strength': 3.1478745303513938, 'grow_policy': 'Lossguide', 'colsample_bylevel': 0.9710334872538622}. Best is trial 7 with value: -32.065779624397976.\n","[I 2023-07-28 00:22:53,737] Trial 13 finished with value: -32.070269635190954 and parameters: {'learning_rate': 0.03373209041581199, 'depth': 7, 'l2_leaf_reg': 2.029736658131497, 'bagging_temperature': 8.567793528868409, 'border_count': 228, 'iterations': 848, 'random_strength': 3.1654925144421266, 'grow_policy': 'Lossguide', 'colsample_bylevel': 0.7407824003109349}. Best is trial 7 with value: -32.065779624397976.\n","[I 2023-07-28 00:22:59,467] Trial 14 finished with value: -32.07126832113888 and parameters: {'learning_rate': 0.038380574680835604, 'depth': 7, 'l2_leaf_reg': 2.3227228446218984, 'bagging_temperature': 8.257527248903365, 'border_count': 253, 'iterations': 860, 'random_strength': 2.6168686555504235, 'grow_policy': 'Lossguide', 'colsample_bylevel': 0.516284724863172}. Best is trial 7 with value: -32.065779624397976.\n","[I 2023-07-28 00:23:06,034] Trial 15 finished with value: -32.08260583769881 and parameters: {'learning_rate': 0.05824109585244846, 'depth': 8, 'l2_leaf_reg': 2.2068443422674116, 'bagging_temperature': 6.529358853713323, 'border_count': 218, 'iterations': 864, 'random_strength': 2.2905758678833052, 'grow_policy': 'Depthwise', 'colsample_bylevel': 0.791638440959799}. Best is trial 7 with value: -32.065779624397976.\n","[I 2023-07-28 00:23:09,339] Trial 16 finished with value: -32.072214398523535 and parameters: {'learning_rate': 0.09771207203429691, 'depth': 6, 'l2_leaf_reg': 4.975119574542795, 'bagging_temperature': 4.0728511262015346, 'border_count': 70, 'iterations': 995, 'random_strength': 5.426940425847151, 'grow_policy': 'Lossguide', 'colsample_bylevel': 0.4752139902347874}. Best is trial 7 with value: -32.065779624397976.\n","[I 2023-07-28 00:23:13,482] Trial 17 finished with value: -32.07550268424684 and parameters: {'learning_rate': 0.07373944730659968, 'depth': 10, 'l2_leaf_reg': 1.512088192204579, 'bagging_temperature': 8.248618198658702, 'border_count': 141, 'iterations': 598, 'random_strength': 3.5511193255209554, 'grow_policy': 'Lossguide', 'colsample_bylevel': 0.7342796147923807}. Best is trial 7 with value: -32.065779624397976.\n","[I 2023-07-28 00:23:22,829] Trial 18 finished with value: -32.07462714119157 and parameters: {'learning_rate': 0.010734159785948064, 'depth': 9, 'l2_leaf_reg': 3.2975958086638517, 'bagging_temperature': 9.536038463518064, 'border_count': 224, 'iterations': 417, 'random_strength': 0.19531988800132805, 'grow_policy': 'Depthwise', 'colsample_bylevel': 0.9686730540575033}. Best is trial 7 with value: -32.065779624397976.\n","[I 2023-07-28 00:23:26,120] Trial 19 finished with value: -32.08278372653766 and parameters: {'learning_rate': 0.04378204851289359, 'depth': 6, 'l2_leaf_reg': 3.055207354031304, 'bagging_temperature': 7.7737560380603625, 'border_count': 116, 'iterations': 844, 'random_strength': 2.5008709902593322, 'grow_policy': 'SymmetricTree', 'colsample_bylevel': 0.7313713526589543}. Best is trial 7 with value: -32.065779624397976.\n","[I 2023-07-28 00:23:34,575] Trial 20 finished with value: -32.07387540013301 and parameters: {'learning_rate': 0.02938727484658047, 'depth': 7, 'l2_leaf_reg': 1.2906473837440091, 'bagging_temperature': 8.575685502854627, 'border_count': 88, 'iterations': 620, 'random_strength': 5.439686195473853, 'grow_policy': 'Lossguide', 'colsample_bylevel': 0.5752432403886584}. Best is trial 7 with value: -32.065779624397976.\n","[I 2023-07-28 00:23:44,019] Trial 21 finished with value: -32.06060167815792 and parameters: {'learning_rate': 0.02794822450891707, 'depth': 4, 'l2_leaf_reg': 0.9925524770005595, 'bagging_temperature': 9.034864806562958, 'border_count': 188, 'iterations': 810, 'random_strength': 3.9712887822111966, 'grow_policy': 'Lossguide', 'colsample_bylevel': 0.6884932330503389}. Best is trial 21 with value: -32.06060167815792.\n","[I 2023-07-28 00:23:54,074] Trial 22 finished with value: -32.066614709699984 and parameters: {'learning_rate': 0.03055508055385774, 'depth': 4, 'l2_leaf_reg': 1.1662747773762132, 'bagging_temperature': 9.131901354615447, 'border_count': 230, 'iterations': 780, 'random_strength': 4.053858855111287, 'grow_policy': 'Lossguide', 'colsample_bylevel': 0.6377867642027432}. Best is trial 21 with value: -32.06060167815792.\n","[I 2023-07-28 00:24:10,050] Trial 23 finished with value: -32.112519141192074 and parameters: {'learning_rate': 0.020216415682292155, 'depth': 4, 'l2_leaf_reg': 1.2644439183699538, 'bagging_temperature': 9.168723759403356, 'border_count': 202, 'iterations': 789, 'random_strength': 4.04137716725747, 'grow_policy': 'Lossguide', 'colsample_bylevel': 0.6489557576762434}. Best is trial 21 with value: -32.06060167815792.\n","[I 2023-07-28 00:24:29,514] Trial 24 finished with value: -32.07048594973578 and parameters: {'learning_rate': 0.03206837315970124, 'depth': 4, 'l2_leaf_reg': 1.1635491671541138, 'bagging_temperature': 9.326647717369912, 'border_count': 146, 'iterations': 907, 'random_strength': 4.589619776558649, 'grow_policy': 'Lossguide', 'colsample_bylevel': 0.5023474446228389}. Best is trial 21 with value: -32.06060167815792.\n","[I 2023-07-28 00:24:35,789] Trial 25 finished with value: -32.0640671742559 and parameters: {'learning_rate': 0.048720243919986216, 'depth': 4, 'l2_leaf_reg': 0.8011115264612703, 'bagging_temperature': 9.975270113865024, 'border_count': 181, 'iterations': 919, 'random_strength': 5.905606889395477, 'grow_policy': 'Lossguide', 'colsample_bylevel': 0.6731486264512218}. Best is trial 21 with value: -32.06060167815792.\n","[I 2023-07-28 00:24:43,826] Trial 26 finished with value: -32.07425269024789 and parameters: {'learning_rate': 0.048450390049475746, 'depth': 6, 'l2_leaf_reg': 3.0238440120435452, 'bagging_temperature': 9.808618594840524, 'border_count': 177, 'iterations': 919, 'random_strength': 5.964979449114384, 'grow_policy': 'Lossguide', 'colsample_bylevel': 0.8235354271380533}. Best is trial 21 with value: -32.06060167815792.\n","[I 2023-07-28 00:24:48,456] Trial 27 finished with value: -32.067931302045615 and parameters: {'learning_rate': 0.06161404650438134, 'depth': 5, 'l2_leaf_reg': 0.7195134943357724, 'bagging_temperature': 8.004687595930196, 'border_count': 143, 'iterations': 928, 'random_strength': 6.2853848671406265, 'grow_policy': 'Lossguide', 'colsample_bylevel': 0.6912510086728704}. Best is trial 21 with value: -32.06060167815792.\n","[I 2023-07-28 00:24:57,774] Trial 28 finished with value: -32.0668379332609 and parameters: {'learning_rate': 0.04757130570389914, 'depth': 4, 'l2_leaf_reg': 0.7628915275352441, 'bagging_temperature': 9.997292258593397, 'border_count': 126, 'iterations': 678, 'random_strength': 5.059719301057372, 'grow_policy': 'Depthwise', 'colsample_bylevel': 0.5563281356305657}. Best is trial 21 with value: -32.06060167815792.\n","[I 2023-07-28 00:25:00,884] Trial 29 finished with value: -32.09841701588318 and parameters: {'learning_rate': 0.05234738868454403, 'depth': 8, 'l2_leaf_reg': 2.4349188274837537, 'bagging_temperature': 7.523826271758251, 'border_count': 157, 'iterations': 667, 'random_strength': 6.864039373134608, 'grow_policy': 'SymmetricTree', 'colsample_bylevel': 0.602745055421546}. Best is trial 21 with value: -32.06060167815792.\n","[I 2023-07-28 00:25:13,033] Trial 30 finished with value: -32.0608366147705 and parameters: {'learning_rate': 0.037705269432421015, 'depth': 5, 'l2_leaf_reg': 1.7585690852547131, 'bagging_temperature': 9.223854646053013, 'border_count': 175, 'iterations': 803, 'random_strength': 1.8386200290520809, 'grow_policy': 'Lossguide', 'colsample_bylevel': 0.8715768298841913}. Best is trial 21 with value: -32.06060167815792.\n","[I 2023-07-28 00:25:26,861] Trial 31 finished with value: -32.06307517160618 and parameters: {'learning_rate': 0.03716233867241336, 'depth': 4, 'l2_leaf_reg': 1.6383210245411512, 'bagging_temperature': 9.02478011230975, 'border_count': 174, 'iterations': 785, 'random_strength': 2.1580845600807406, 'grow_policy': 'Lossguide', 'colsample_bylevel': 0.8800521683547262}. Best is trial 21 with value: -32.06060167815792.\n","[I 2023-07-28 00:25:36,155] Trial 32 finished with value: -32.065935721162624 and parameters: {'learning_rate': 0.03750576646748371, 'depth': 4, 'l2_leaf_reg': 0.11693096914639778, 'bagging_temperature': 9.123437153583623, 'border_count': 168, 'iterations': 761, 'random_strength': 1.7614033425399918, 'grow_policy': 'Lossguide', 'colsample_bylevel': 0.879893566860028}. Best is trial 21 with value: -32.06060167815792.\n","[I 2023-07-28 00:25:44,207] Trial 33 finished with value: -32.06808980908705 and parameters: {'learning_rate': 0.03697219295413817, 'depth': 5, 'l2_leaf_reg': 0.7759485325844555, 'bagging_temperature': 9.369350519659825, 'border_count': 185, 'iterations': 797, 'random_strength': 1.5730473422070257, 'grow_policy': 'Lossguide', 'colsample_bylevel': 0.8952514637295141}. Best is trial 21 with value: -32.06060167815792.\n","[I 2023-07-28 00:25:50,159] Trial 34 finished with value: -32.07164001002916 and parameters: {'learning_rate': 0.043033445122297335, 'depth': 4, 'l2_leaf_reg': 2.7032291558431227, 'bagging_temperature': 8.854870504304815, 'border_count': 204, 'iterations': 622, 'random_strength': 0.5319778991868651, 'grow_policy': 'Lossguide', 'colsample_bylevel': 0.8466537120689853}. Best is trial 21 with value: -32.06060167815792.\n","[I 2023-07-28 00:25:59,258] Trial 35 finished with value: -32.06316588202626 and parameters: {'learning_rate': 0.027470620026912154, 'depth': 5, 'l2_leaf_reg': 1.7183217964933428, 'bagging_temperature': 8.82833864915193, 'border_count': 169, 'iterations': 717, 'random_strength': 2.2930944379027434, 'grow_policy': 'Lossguide', 'colsample_bylevel': 0.7653582188983769}. Best is trial 21 with value: -32.06060167815792.\n","[I 2023-07-28 00:26:10,322] Trial 36 finished with value: -32.06863048202926 and parameters: {'learning_rate': 0.024164524584723398, 'depth': 5, 'l2_leaf_reg': 1.6734836361383527, 'bagging_temperature': 6.824304551029469, 'border_count': 166, 'iterations': 708, 'random_strength': 1.9882857411800077, 'grow_policy': 'Lossguide', 'colsample_bylevel': 0.7749597090859494}. Best is trial 21 with value: -32.06060167815792.\n","[I 2023-07-28 00:26:19,345] Trial 37 finished with value: -32.07063104421876 and parameters: {'learning_rate': 0.029185352034591355, 'depth': 5, 'l2_leaf_reg': 3.9271556798637612, 'bagging_temperature': 7.78347976809394, 'border_count': 194, 'iterations': 469, 'random_strength': 0.9920629942664623, 'grow_policy': 'Lossguide', 'colsample_bylevel': 0.9255645480841528}. Best is trial 21 with value: -32.06060167815792.\n","[I 2023-07-28 00:26:24,926] Trial 38 finished with value: -32.30749517899469 and parameters: {'learning_rate': 0.019347750389471913, 'depth': 6, 'l2_leaf_reg': 1.868409889137162, 'bagging_temperature': 8.761763902978316, 'border_count': 209, 'iterations': 298, 'random_strength': 2.820153846806476, 'grow_policy': 'Lossguide', 'colsample_bylevel': 0.826963764076628}. Best is trial 21 with value: -32.06060167815792.\n","[I 2023-07-28 00:26:30,066] Trial 39 finished with value: -32.07212492273256 and parameters: {'learning_rate': 0.026657878349821095, 'depth': 5, 'l2_leaf_reg': 2.612208118408912, 'bagging_temperature': 5.9757689798568006, 'border_count': 168, 'iterations': 731, 'random_strength': 0.8670352724616015, 'grow_policy': 'Depthwise', 'colsample_bylevel': 0.9970743199779457}. Best is trial 21 with value: -32.06060167815792.\n","[I 2023-07-28 00:26:33,769] Trial 40 finished with value: -32.069897580322696 and parameters: {'learning_rate': 0.03431961039166284, 'depth': 5, 'l2_leaf_reg': 1.6970734584026799, 'bagging_temperature': 7.108769410528197, 'border_count': 197, 'iterations': 589, 'random_strength': 1.8919264986330973, 'grow_policy': 'SymmetricTree', 'colsample_bylevel': 0.8621221144315905}. Best is trial 21 with value: -32.06060167815792.\n","[I 2023-07-28 00:26:42,542] Trial 41 finished with value: -32.07255958670526 and parameters: {'learning_rate': 0.041998543553645566, 'depth': 4, 'l2_leaf_reg': 0.6695693562744917, 'bagging_temperature': 9.544052516442617, 'border_count': 181, 'iterations': 807, 'random_strength': 2.330494933002157, 'grow_policy': 'Lossguide', 'colsample_bylevel': 0.6998570456180417}. Best is trial 21 with value: -32.06060167815792.\n","[I 2023-07-28 00:27:00,451] Trial 42 finished with value: -32.06727058819422 and parameters: {'learning_rate': 0.034083215291949756, 'depth': 4, 'l2_leaf_reg': 0.98990977725325, 'bagging_temperature': 9.047445559535447, 'border_count': 155, 'iterations': 888, 'random_strength': 2.9650112957166606, 'grow_policy': 'Lossguide', 'colsample_bylevel': 0.7597959053890313}. Best is trial 21 with value: -32.06060167815792.\n","[I 2023-07-28 00:27:08,749] Trial 43 finished with value: -32.074574428803686 and parameters: {'learning_rate': 0.04636227805539798, 'depth': 4, 'l2_leaf_reg': 1.475076361524949, 'bagging_temperature': 9.99694918389578, 'border_count': 188, 'iterations': 737, 'random_strength': 1.367837734481685, 'grow_policy': 'Lossguide', 'colsample_bylevel': 0.8201437800217334}. Best is trial 21 with value: -32.06060167815792.\n","[I 2023-07-28 00:27:20,133] Trial 44 finished with value: -32.06154192311382 and parameters: {'learning_rate': 0.03829398606128312, 'depth': 5, 'l2_leaf_reg': 0.4995932033345832, 'bagging_temperature': 8.067511068769779, 'border_count': 213, 'iterations': 818, 'random_strength': 3.5521152470152617, 'grow_policy': 'Lossguide', 'colsample_bylevel': 0.925212639734758}. Best is trial 21 with value: -32.06060167815792.\n","[I 2023-07-28 00:27:32,562] Trial 45 finished with value: -32.07823850837143 and parameters: {'learning_rate': 0.02239569869477298, 'depth': 5, 'l2_leaf_reg': 0.4396315124448995, 'bagging_temperature': 8.244651190302992, 'border_count': 211, 'iterations': 667, 'random_strength': 3.6319292537529595, 'grow_policy': 'Lossguide', 'colsample_bylevel': 0.9370851923545463}. Best is trial 21 with value: -32.06060167815792.\n","[I 2023-07-28 00:27:38,649] Trial 46 finished with value: -32.0693766719068 and parameters: {'learning_rate': 0.039008619574206045, 'depth': 6, 'l2_leaf_reg': 1.9109300052499048, 'bagging_temperature': 7.598943987299174, 'border_count': 240, 'iterations': 809, 'random_strength': 2.250350240118916, 'grow_policy': 'Lossguide', 'colsample_bylevel': 0.86069796758889}. Best is trial 21 with value: -32.06060167815792.\n","[I 2023-07-28 00:27:50,000] Trial 47 finished with value: -32.061172276538315 and parameters: {'learning_rate': 0.02730891637444845, 'depth': 5, 'l2_leaf_reg': 0.13042950650214424, 'bagging_temperature': 8.771467518471798, 'border_count': 172, 'iterations': 751, 'random_strength': 2.822693938819521, 'grow_policy': 'Lossguide', 'colsample_bylevel': 0.9153959276600862}. Best is trial 21 with value: -32.06060167815792.\n","[I 2023-07-28 00:27:57,498] Trial 48 finished with value: -32.065130438693664 and parameters: {'learning_rate': 0.03387301598461938, 'depth': 5, 'l2_leaf_reg': 0.14538490155111794, 'bagging_temperature': 8.451553123009187, 'border_count': 213, 'iterations': 830, 'random_strength': 2.884212929636231, 'grow_policy': 'SymmetricTree', 'colsample_bylevel': 0.9324997825638842}. Best is trial 21 with value: -32.06060167815792.\n","[I 2023-07-28 00:28:05,175] Trial 49 finished with value: -32.07150636482679 and parameters: {'learning_rate': 0.04032715278955064, 'depth': 6, 'l2_leaf_reg': 0.6140301252136809, 'bagging_temperature': 7.874444255293568, 'border_count': 194, 'iterations': 764, 'random_strength': 3.7876791882884007, 'grow_policy': 'Lossguide', 'colsample_bylevel': 0.8801606375423164}. Best is trial 21 with value: -32.06060167815792.\n","[I 2023-07-28 00:28:16,203] Trial 50 finished with value: -32.07156362466631 and parameters: {'learning_rate': 0.017370038888010288, 'depth': 5, 'l2_leaf_reg': 1.1200496998457459, 'bagging_temperature': 9.529438310058877, 'border_count': 135, 'iterations': 891, 'random_strength': 3.422745087789784, 'grow_policy': 'Depthwise', 'colsample_bylevel': 0.9114083621571393}. Best is trial 21 with value: -32.06060167815792.\n","[I 2023-07-28 00:28:25,788] Trial 51 finished with value: -32.06503821805836 and parameters: {'learning_rate': 0.026225870605715695, 'depth': 5, 'l2_leaf_reg': 2.16732197191288, 'bagging_temperature': 8.765316199262633, 'border_count': 169, 'iterations': 713, 'random_strength': 2.797365204938615, 'grow_policy': 'Lossguide', 'colsample_bylevel': 0.805429015745953}. Best is trial 21 with value: -32.06060167815792.\n","[I 2023-07-28 00:28:36,535] Trial 52 finished with value: -32.070967735388486 and parameters: {'learning_rate': 0.02760534222793616, 'depth': 6, 'l2_leaf_reg': 0.454814045941534, 'bagging_temperature': 8.81458005754321, 'border_count': 156, 'iterations': 749, 'random_strength': 2.1000688404267684, 'grow_policy': 'Lossguide', 'colsample_bylevel': 0.850019333382945}. Best is trial 21 with value: -32.06060167815792.\n","[I 2023-07-28 00:28:47,216] Trial 53 finished with value: -32.07222830824104 and parameters: {'learning_rate': 0.02252655684419019, 'depth': 5, 'l2_leaf_reg': 1.5018170985922576, 'bagging_temperature': 8.261928381720185, 'border_count': 173, 'iterations': 870, 'random_strength': 3.2215225389920366, 'grow_policy': 'Lossguide', 'colsample_bylevel': 0.7785429990125214}. Best is trial 21 with value: -32.06060167815792.\n","[I 2023-07-28 00:28:54,330] Trial 54 finished with value: -32.06402124043408 and parameters: {'learning_rate': 0.03708673056051431, 'depth': 4, 'l2_leaf_reg': 1.0081895156965972, 'bagging_temperature': 8.043602656558633, 'border_count': 187, 'iterations': 954, 'random_strength': 4.284132119793927, 'grow_policy': 'Lossguide', 'colsample_bylevel': 0.9732445090207782}. Best is trial 21 with value: -32.06060167815792.\n","[I 2023-07-28 00:29:04,318] Trial 55 finished with value: -32.076785706736295 and parameters: {'learning_rate': 0.0303360268849732, 'depth': 5, 'l2_leaf_reg': 2.138072694250202, 'bagging_temperature': 8.525461018298317, 'border_count': 149, 'iterations': 701, 'random_strength': 2.5322742802795917, 'grow_policy': 'Lossguide', 'colsample_bylevel': 0.8873769025772801}. Best is trial 21 with value: -32.06060167815792.\n","[I 2023-07-28 00:29:14,223] Trial 56 finished with value: -32.06320424755441 and parameters: {'learning_rate': 0.025808272962411134, 'depth': 4, 'l2_leaf_reg': 0.3568180391555, 'bagging_temperature': 9.492790389809347, 'border_count': 220, 'iterations': 823, 'random_strength': 1.2935895922710787, 'grow_policy': 'Lossguide', 'colsample_bylevel': 0.7328202736723083}. Best is trial 21 with value: -32.06060167815792.\n","[I 2023-07-28 00:29:21,464] Trial 57 finished with value: -32.06950169568699 and parameters: {'learning_rate': 0.0328039009998527, 'depth': 5, 'l2_leaf_reg': 1.5460895081193768, 'bagging_temperature': 9.02395381653803, 'border_count': 161, 'iterations': 633, 'random_strength': 3.2346414731204103, 'grow_policy': 'Lossguide', 'colsample_bylevel': 0.944365598759084}. Best is trial 21 with value: -32.06060167815792.\n","[I 2023-07-28 00:29:28,542] Trial 58 finished with value: -32.07405683922329 and parameters: {'learning_rate': 0.044303928367477347, 'depth': 6, 'l2_leaf_reg': 1.2956215599539238, 'bagging_temperature': 7.454848364913764, 'border_count': 176, 'iterations': 786, 'random_strength': 1.6867275650379994, 'grow_policy': 'Lossguide', 'colsample_bylevel': 0.7984253043162689}. Best is trial 21 with value: -32.06060167815792.\n","[I 2023-07-28 00:29:31,867] Trial 59 finished with value: -32.10765267577885 and parameters: {'learning_rate': 0.028129863065303767, 'depth': 4, 'l2_leaf_reg': 0.10485016483605009, 'bagging_temperature': 8.501179592753285, 'border_count': 234, 'iterations': 651, 'random_strength': 2.4892450022295893, 'grow_policy': 'SymmetricTree', 'colsample_bylevel': 0.9066637439159821}. Best is trial 21 with value: -32.06060167815792.\n","[I 2023-07-28 00:29:39,772] Trial 60 finished with value: -32.29952791986276 and parameters: {'learning_rate': 0.014910436927768382, 'depth': 5, 'l2_leaf_reg': 1.8697619457643178, 'bagging_temperature': 9.280572037233373, 'border_count': 201, 'iterations': 561, 'random_strength': 3.746806594076699, 'grow_policy': 'Lossguide', 'colsample_bylevel': 0.8338660523548688}. Best is trial 21 with value: -32.06060167815792.\n","[I 2023-07-28 00:29:49,357] Trial 61 finished with value: -32.066458715732914 and parameters: {'learning_rate': 0.024181152803628692, 'depth': 4, 'l2_leaf_reg': 0.49903575059343724, 'bagging_temperature': 9.593352944314399, 'border_count': 220, 'iterations': 836, 'random_strength': 1.28989954020662, 'grow_policy': 'Lossguide', 'colsample_bylevel': 0.7196429276164235}. Best is trial 21 with value: -32.06060167815792.\n","[I 2023-07-28 00:29:59,076] Trial 62 finished with value: -32.071152539276824 and parameters: {'learning_rate': 0.03089344403942846, 'depth': 4, 'l2_leaf_reg': 0.3475031134725173, 'bagging_temperature': 9.587190336756597, 'border_count': 248, 'iterations': 819, 'random_strength': 2.043712538924049, 'grow_policy': 'Lossguide', 'colsample_bylevel': 0.7387317533171324}. Best is trial 21 with value: -32.06060167815792.\n","[I 2023-07-28 00:30:06,858] Trial 63 finished with value: -32.06000168604456 and parameters: {'learning_rate': 0.03541464030551373, 'depth': 4, 'l2_leaf_reg': 0.8768934711871211, 'bagging_temperature': 8.970416711634249, 'border_count': 220, 'iterations': 864, 'random_strength': 1.4305491933861, 'grow_policy': 'Lossguide', 'colsample_bylevel': 0.7699082011018098}. Best is trial 63 with value: -32.06000168604456.\n","[I 2023-07-28 00:30:14,025] Trial 64 finished with value: -32.059653012148615 and parameters: {'learning_rate': 0.03486892621568233, 'depth': 4, 'l2_leaf_reg': 0.9614237993085483, 'bagging_temperature': 8.908422167372004, 'border_count': 181, 'iterations': 871, 'random_strength': 2.2836161006999105, 'grow_policy': 'Lossguide', 'colsample_bylevel': 0.7707873773187668}. Best is trial 64 with value: -32.059653012148615.\n","[I 2023-07-28 00:30:22,712] Trial 65 finished with value: -32.072382219872765 and parameters: {'learning_rate': 0.035881237857353025, 'depth': 4, 'l2_leaf_reg': 0.9441827225028491, 'bagging_temperature': 8.106478804430692, 'border_count': 192, 'iterations': 955, 'random_strength': 1.6931308447883013, 'grow_policy': 'Depthwise', 'colsample_bylevel': 0.7966201626142908}. Best is trial 64 with value: -32.059653012148615.\n","[I 2023-07-28 00:30:29,146] Trial 66 finished with value: -32.050691907737985 and parameters: {'learning_rate': 0.04042387659828879, 'depth': 4, 'l2_leaf_reg': 0.9548339895233696, 'bagging_temperature': 9.202692662045445, 'border_count': 206, 'iterations': 882, 'random_strength': 2.650521044130361, 'grow_policy': 'Lossguide', 'colsample_bylevel': 0.8623555990268328}. Best is trial 66 with value: -32.050691907737985.\n","[I 2023-07-28 00:30:37,547] Trial 67 finished with value: -32.06875595510729 and parameters: {'learning_rate': 0.04068749882371673, 'depth': 4, 'l2_leaf_reg': 0.8650927538473212, 'bagging_temperature': 9.303597485254425, 'border_count': 232, 'iterations': 876, 'random_strength': 2.6718472244436384, 'grow_policy': 'Lossguide', 'colsample_bylevel': 0.8405286835018225}. Best is trial 66 with value: -32.050691907737985.\n","[I 2023-07-28 00:30:46,116] Trial 68 finished with value: -32.05877950358112 and parameters: {'learning_rate': 0.03952303927326993, 'depth': 4, 'l2_leaf_reg': 1.2320539202566767, 'bagging_temperature': 9.749176599094191, 'border_count': 213, 'iterations': 947, 'random_strength': 3.035048985275515, 'grow_policy': 'Lossguide', 'colsample_bylevel': 0.7653716622727373}. Best is trial 66 with value: -32.050691907737985.\n","[I 2023-07-28 00:30:51,999] Trial 69 finished with value: -32.06311286783042 and parameters: {'learning_rate': 0.04543417751817266, 'depth': 4, 'l2_leaf_reg': 1.2791510425408115, 'bagging_temperature': 9.716146826101863, 'border_count': 201, 'iterations': 968, 'random_strength': 3.0753791966876243, 'grow_policy': 'Lossguide', 'colsample_bylevel': 0.7621934403583361}. Best is trial 66 with value: -32.050691907737985.\n","[I 2023-07-28 00:31:01,218] Trial 70 finished with value: -32.059424984001744 and parameters: {'learning_rate': 0.031830300019365036, 'depth': 4, 'l2_leaf_reg': 1.0595057248696937, 'bagging_temperature': 9.149635446476214, 'border_count': 183, 'iterations': 936, 'random_strength': 2.561535841535581, 'grow_policy': 'Lossguide', 'colsample_bylevel': 0.6734625904974991}. Best is trial 66 with value: -32.050691907737985.\n","[I 2023-07-28 00:31:10,741] Trial 71 finished with value: -32.06330790119287 and parameters: {'learning_rate': 0.03168689407799801, 'depth': 4, 'l2_leaf_reg': 0.9656269302952718, 'bagging_temperature': 9.73915650362637, 'border_count': 184, 'iterations': 1000, 'random_strength': 2.6099008311484373, 'grow_policy': 'Lossguide', 'colsample_bylevel': 0.6813162566361071}. Best is trial 66 with value: -32.050691907737985.\n","[I 2023-07-28 00:31:16,777] Trial 72 finished with value: -32.07811834849338 and parameters: {'learning_rate': 0.03475222359465882, 'depth': 9, 'l2_leaf_reg': 1.2506288807890076, 'bagging_temperature': 9.054549593111627, 'border_count': 205, 'iterations': 913, 'random_strength': 3.039767798562906, 'grow_policy': 'Lossguide', 'colsample_bylevel': 0.7045293890393494}. Best is trial 66 with value: -32.050691907737985.\n","[I 2023-07-28 00:31:25,819] Trial 73 finished with value: -32.062027117672415 and parameters: {'learning_rate': 0.031711423370144806, 'depth': 4, 'l2_leaf_reg': 0.6577604664458047, 'bagging_temperature': 9.203202666194278, 'border_count': 197, 'iterations': 853, 'random_strength': 1.9574637490457931, 'grow_policy': 'Lossguide', 'colsample_bylevel': 0.6546542376206781}. Best is trial 66 with value: -32.050691907737985.\n","[I 2023-07-28 00:31:31,220] Trial 74 finished with value: -32.079300185401856 and parameters: {'learning_rate': 0.04173433959360471, 'depth': 4, 'l2_leaf_reg': 2.303157049906042, 'bagging_temperature': 8.606430712368516, 'border_count': 53, 'iterations': 935, 'random_strength': 1.6109950807857616, 'grow_policy': 'Lossguide', 'colsample_bylevel': 0.6056407336956348}. Best is trial 66 with value: -32.050691907737985.\n","[I 2023-07-28 00:31:38,800] Trial 75 finished with value: -32.06704544516987 and parameters: {'learning_rate': 0.040292417553652905, 'depth': 4, 'l2_leaf_reg': 1.387670438837469, 'bagging_temperature': 9.775677009174794, 'border_count': 225, 'iterations': 894, 'random_strength': 3.334437490789534, 'grow_policy': 'Lossguide', 'colsample_bylevel': 0.7545384668368166}. Best is trial 66 with value: -32.050691907737985.\n","[I 2023-07-28 00:31:46,700] Trial 76 finished with value: -32.06344288114799 and parameters: {'learning_rate': 0.036042990982892216, 'depth': 4, 'l2_leaf_reg': 1.0418012512390364, 'bagging_temperature': 8.856193825117193, 'border_count': 217, 'iterations': 945, 'random_strength': 2.736412471576114, 'grow_policy': 'Lossguide', 'colsample_bylevel': 0.7144254135552329}. Best is trial 66 with value: -32.050691907737985.\n","[I 2023-07-28 00:31:52,793] Trial 77 finished with value: -32.07656141651736 and parameters: {'learning_rate': 0.028877098101685178, 'depth': 4, 'l2_leaf_reg': 0.8061297711318816, 'bagging_temperature': 9.47378393741266, 'border_count': 183, 'iterations': 987, 'random_strength': 2.342180734730476, 'grow_policy': 'SymmetricTree', 'colsample_bylevel': 0.8083828748105277}. Best is trial 66 with value: -32.050691907737985.\n","[I 2023-07-28 00:31:57,749] Trial 78 finished with value: -32.059692508715095 and parameters: {'learning_rate': 0.0449404595505995, 'depth': 4, 'l2_leaf_reg': 1.9528262136121475, 'bagging_temperature': 9.292780274042052, 'border_count': 178, 'iterations': 862, 'random_strength': 4.238834123317299, 'grow_policy': 'Depthwise', 'colsample_bylevel': 0.6795568073632559}. Best is trial 66 with value: -32.050691907737985.\n","[I 2023-07-28 00:32:04,569] Trial 79 finished with value: -32.06836606122162 and parameters: {'learning_rate': 0.04381079075940777, 'depth': 4, 'l2_leaf_reg': 1.8439390872781858, 'bagging_temperature': 9.28353555079574, 'border_count': 239, 'iterations': 906, 'random_strength': 4.237316654950233, 'grow_policy': 'Depthwise', 'colsample_bylevel': 0.6642689763850458}. Best is trial 66 with value: -32.050691907737985.\n","[I 2023-07-28 00:32:10,134] Trial 80 finished with value: -32.074380860166116 and parameters: {'learning_rate': 0.03884768522133896, 'depth': 4, 'l2_leaf_reg': 2.490291007529917, 'bagging_temperature': 9.842360961101894, 'border_count': 162, 'iterations': 845, 'random_strength': 3.9530501527660293, 'grow_policy': 'Depthwise', 'colsample_bylevel': 0.6344632626666272}. Best is trial 66 with value: -32.050691907737985.\n","[I 2023-07-28 00:32:17,768] Trial 81 finished with value: -32.05971488261791 and parameters: {'learning_rate': 0.035215340433712106, 'depth': 4, 'l2_leaf_reg': 1.3735885615304189, 'bagging_temperature': 9.059377019594148, 'border_count': 180, 'iterations': 869, 'random_strength': 3.2656870443837986, 'grow_policy': 'Depthwise', 'colsample_bylevel': 0.6911915299953153}. Best is trial 66 with value: -32.050691907737985.\n","[I 2023-07-28 00:32:24,008] Trial 82 finished with value: -32.06315483039699 and parameters: {'learning_rate': 0.035335335463625786, 'depth': 4, 'l2_leaf_reg': 1.4215595538818855, 'bagging_temperature': 9.034313351828747, 'border_count': 177, 'iterations': 869, 'random_strength': 4.384848117081394, 'grow_policy': 'Depthwise', 'colsample_bylevel': 0.6796068461571892}. Best is trial 66 with value: -32.050691907737985.\n","[I 2023-07-28 00:32:31,722] Trial 83 finished with value: -32.06248032286099 and parameters: {'learning_rate': 0.04289698776090019, 'depth': 4, 'l2_leaf_reg': 2.12423704628797, 'bagging_temperature': 8.463205797411758, 'border_count': 190, 'iterations': 932, 'random_strength': 3.872216823766048, 'grow_policy': 'Depthwise', 'colsample_bylevel': 0.6981956152681666}. Best is trial 66 with value: -32.050691907737985.\n","[I 2023-07-28 00:32:36,040] Trial 84 finished with value: -32.065492780426254 and parameters: {'learning_rate': 0.04983601197649067, 'depth': 4, 'l2_leaf_reg': 1.6734235850518688, 'bagging_temperature': 9.328300865687883, 'border_count': 207, 'iterations': 884, 'random_strength': 3.4445216139763852, 'grow_policy': 'Depthwise', 'colsample_bylevel': 0.7816406138190028}. Best is trial 66 with value: -32.050691907737985.\n","[I 2023-07-28 00:32:44,184] Trial 85 finished with value: -32.05544883296025 and parameters: {'learning_rate': 0.033256945176744566, 'depth': 4, 'l2_leaf_reg': 1.162517607500003, 'bagging_temperature': 9.989853855358167, 'border_count': 198, 'iterations': 856, 'random_strength': 3.048684785262487, 'grow_policy': 'Depthwise', 'colsample_bylevel': 0.7417424795004836}. Best is trial 66 with value: -32.050691907737985.\n","[I 2023-07-28 00:32:51,020] Trial 86 finished with value: -32.06467191137622 and parameters: {'learning_rate': 0.03396616095043625, 'depth': 4, 'l2_leaf_reg': 1.1041639687532565, 'bagging_temperature': 9.985547927682848, 'border_count': 199, 'iterations': 971, 'random_strength': 3.5884672141059135, 'grow_policy': 'Depthwise', 'colsample_bylevel': 0.7309693529744092}. Best is trial 66 with value: -32.050691907737985.\n","[I 2023-07-28 00:32:58,455] Trial 87 finished with value: -32.078796113300704 and parameters: {'learning_rate': 0.031945091435669065, 'depth': 4, 'l2_leaf_reg': 0.6303919646534131, 'bagging_temperature': 9.716792718115853, 'border_count': 215, 'iterations': 908, 'random_strength': 3.120035330819267, 'grow_policy': 'Depthwise', 'colsample_bylevel': 0.6254934867801095}. Best is trial 66 with value: -32.050691907737985.\n","[I 2023-07-28 00:33:00,770] Trial 88 finished with value: -32.425364414602036 and parameters: {'learning_rate': 0.038695709362195824, 'depth': 4, 'l2_leaf_reg': 1.9795553023157193, 'bagging_temperature': 9.465969558769466, 'border_count': 208, 'iterations': 255, 'random_strength': 4.7791643807393935, 'grow_policy': 'Depthwise', 'colsample_bylevel': 0.7537884997857993}. Best is trial 66 with value: -32.050691907737985.\n","[I 2023-07-28 00:33:07,514] Trial 89 finished with value: -32.06633592264005 and parameters: {'learning_rate': 0.04567607723294354, 'depth': 4, 'l2_leaf_reg': 1.5181060654827254, 'bagging_temperature': 8.853327075136232, 'border_count': 193, 'iterations': 867, 'random_strength': 4.063438157381421, 'grow_policy': 'Depthwise', 'colsample_bylevel': 0.6720888876206276}. Best is trial 66 with value: -32.050691907737985.\n","[I 2023-07-28 00:33:14,233] Trial 90 finished with value: -32.060806425458054 and parameters: {'learning_rate': 0.03044172779829636, 'depth': 4, 'l2_leaf_reg': 1.2067238076710463, 'bagging_temperature': 9.989555823658778, 'border_count': 226, 'iterations': 856, 'random_strength': 3.3540869660969155, 'grow_policy': 'Depthwise', 'colsample_bylevel': 0.7203560465672377}. Best is trial 66 with value: -32.050691907737985.\n","[I 2023-07-28 00:33:15,628] Trial 91 finished with value: -32.551648508450164 and parameters: {'learning_rate': 0.0300595334200143, 'depth': 4, 'l2_leaf_reg': 1.1403548607100622, 'bagging_temperature': 9.804950165154878, 'border_count': 226, 'iterations': 134, 'random_strength': 2.948777600750726, 'grow_policy': 'Depthwise', 'colsample_bylevel': 0.7125981248798319}. Best is trial 66 with value: -32.050691907737985.\n","[I 2023-07-28 00:33:20,694] Trial 92 finished with value: -32.14661537110194 and parameters: {'learning_rate': 0.03565949483861179, 'depth': 4, 'l2_leaf_reg': 0.9066342840519925, 'bagging_temperature': 9.123258430765594, 'border_count': 223, 'iterations': 386, 'random_strength': 3.326956062837861, 'grow_policy': 'Depthwise', 'colsample_bylevel': 0.6998814865075895}. Best is trial 66 with value: -32.050691907737985.\n","[I 2023-07-28 00:33:26,370] Trial 93 finished with value: -32.0629762979008 and parameters: {'learning_rate': 0.03317258983851771, 'depth': 4, 'l2_leaf_reg': 1.4133789406494046, 'bagging_temperature': 9.454710475910238, 'border_count': 181, 'iterations': 852, 'random_strength': 2.5364985640673297, 'grow_policy': 'Depthwise', 'colsample_bylevel': 0.7477281645117245}. Best is trial 66 with value: -32.050691907737985.\n","[I 2023-07-28 00:33:34,021] Trial 94 finished with value: -32.0800298938926 and parameters: {'learning_rate': 0.042063632367837424, 'depth': 4, 'l2_leaf_reg': 0.8134262421777939, 'bagging_temperature': 8.654332060831361, 'border_count': 247, 'iterations': 922, 'random_strength': 3.6784636205576025, 'grow_policy': 'Depthwise', 'colsample_bylevel': 0.7767962246384272}. Best is trial 66 with value: -32.050691907737985.\n","[I 2023-07-28 00:33:40,571] Trial 95 finished with value: -32.06386245852638 and parameters: {'learning_rate': 0.029979305140408558, 'depth': 4, 'l2_leaf_reg': 0.3709575234108806, 'bagging_temperature': 9.996110198264141, 'border_count': 211, 'iterations': 773, 'random_strength': 3.146616769317402, 'grow_policy': 'Depthwise', 'colsample_bylevel': 0.658769570770702}. Best is trial 66 with value: -32.050691907737985.\n","[I 2023-07-28 00:33:47,709] Trial 96 finished with value: -32.05447601962625 and parameters: {'learning_rate': 0.03980584813164483, 'depth': 4, 'l2_leaf_reg': 1.2014475929433912, 'bagging_temperature': 8.322266016940164, 'border_count': 187, 'iterations': 898, 'random_strength': 3.4503518101938835, 'grow_policy': 'Depthwise', 'colsample_bylevel': 0.7304634237791398}. Best is trial 66 with value: -32.050691907737985.\n","[I 2023-07-28 00:33:53,368] Trial 97 finished with value: -32.06260669343971 and parameters: {'learning_rate': 0.0378652051509787, 'depth': 4, 'l2_leaf_reg': 1.7007935447515923, 'bagging_temperature': 8.392838497893232, 'border_count': 190, 'iterations': 897, 'random_strength': 2.234070130450437, 'grow_policy': 'Depthwise', 'colsample_bylevel': 0.6882880874465654}. Best is trial 66 with value: -32.050691907737985.\n","[I 2023-07-28 00:34:02,345] Trial 98 finished with value: -32.0822844139221 and parameters: {'learning_rate': 0.03971080164941084, 'depth': 10, 'l2_leaf_reg': 0.6019052313051166, 'bagging_temperature': 8.975944961372525, 'border_count': 179, 'iterations': 949, 'random_strength': 2.932251308406549, 'grow_policy': 'Depthwise', 'colsample_bylevel': 0.7402754229712822}. Best is trial 66 with value: -32.050691907737985.\n","[I 2023-07-28 00:34:12,177] Trial 99 finished with value: -32.055527503089614 and parameters: {'learning_rate': 0.03626601532420276, 'depth': 4, 'l2_leaf_reg': 1.3518705359642085, 'bagging_temperature': 8.302053219353951, 'border_count': 186, 'iterations': 981, 'random_strength': 3.558212842896175, 'grow_policy': 'Depthwise', 'colsample_bylevel': 0.7870763087785279}. Best is trial 66 with value: -32.050691907737985.\n"]}],"source":["def objective(trial):\n","    params = {\n","        'learning_rate': trial.suggest_float('learning_rate', 0.01, 0.1),\n","        'depth': trial.suggest_int('depth', 4, 10),\n","        'l2_leaf_reg': trial.suggest_float('l2_leaf_reg', 0.1, 10),\n","        'bagging_temperature': trial.suggest_float('bagging_temperature', 0, 10),\n","        'border_count': trial.suggest_int('border_count', 32, 255),\n","        'iterations': trial.suggest_int('iterations', 100, 1000),\n","        'random_strength': trial.suggest_float('random_strength', 0.1, 10),\n","        'grow_policy': trial.suggest_categorical('grow_policy', ['SymmetricTree', 'Depthwise', 'Lossguide']),\n","        'colsample_bylevel': trial.suggest_float('colsample_bylevel', 0.1, 1),\n","    }\n","\n","    model3 = cat.CatBoostRegressor(**params, random_seed=42, verbose=False)\n","    model3.fit(x_train, y_train, eval_set=(x_train_test, y_test), early_stopping_rounds=100, verbose=False)\n","\n","    y_pred = model3.predict(x_train_test)\n","    mse = mean_squared_error(y_test, y_pred)\n","\n","    return -mse\n","\n","study = optuna.create_study(direction='maximize')\n","study.optimize(objective, n_trials=100)\n","\n","best_params = study.best_params\n","best_model = cat.CatBoostRegressor(**best_params, random_seed=42, verbose=False)\n","best_model.fit(x_train, y_train)\n","predCat = best_model.predict(test)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"6pAvsxmf8Gde"},"outputs":[],"source":["x_train = pd.DataFrame(x_train)\n","test = pd.DataFrame(test)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":810},"executionInfo":{"elapsed":2739364,"status":"error","timestamp":1690509942416,"user":{"displayName":"Musa Muhammad","userId":"05399772858105698249"},"user_tz":-60},"id":"-E3jzjhb4YKg","outputId":"41c42c42-1447-4c4f-b627-cd2f0a026fa2"},"outputs":[{"name":"stderr","output_type":"stream","text":["[I 2023-07-28 01:20:02,646] A new study created in memory with name: no-name-b639994b-7893-4435-8c1a-ca57655979f1\n","/usr/local/lib/python3.10/dist-packages/optuna/distributions.py:700: UserWarning: The distribution is specified by [700, 2000] and step=500, but the range is not divisible by `step`. It will be replaced by [700, 1700].\n","  warnings.warn(\n","[I 2023-07-28 01:22:57,108] Trial 0 finished with value: -32.28802214238723 and parameters: {'n_estimators': 1200, 'learning_rate': 0.026355892070438723, 'booster': 'gbtree', 'lambda': 0.047048695934073494, 'alpha': 0.01858739607977995, 'subsample': 0.8982052537648504, 'colsample_bytree': 0.7579757817332986, 'max_depth': 7, 'min_child_weight': 13, 'eta': 0.253241798258293, 'gamma': 0.714682807667269}. Best is trial 0 with value: -32.28802214238723.\n","/usr/local/lib/python3.10/dist-packages/optuna/distributions.py:700: UserWarning: The distribution is specified by [700, 2000] and step=500, but the range is not divisible by `step`. It will be replaced by [700, 1700].\n","  warnings.warn(\n","[I 2023-07-28 01:28:54,656] Trial 1 finished with value: -32.307207799625665 and parameters: {'n_estimators': 1200, 'learning_rate': 0.04634553707291667, 'booster': 'gbtree', 'lambda': 0.07226281772611835, 'alpha': 0.0025895882035211013, 'subsample': 0.6428364094466629, 'colsample_bytree': 0.8537590060866662, 'max_depth': 20, 'min_child_weight': 13, 'eta': 0.9819305645065978, 'gamma': 0.8300663082885493}. Best is trial 0 with value: -32.28802214238723.\n","/usr/local/lib/python3.10/dist-packages/optuna/distributions.py:700: UserWarning: The distribution is specified by [700, 2000] and step=500, but the range is not divisible by `step`. It will be replaced by [700, 1700].\n","  warnings.warn(\n","[I 2023-07-28 01:30:33,998] Trial 2 finished with value: -32.28275705456003 and parameters: {'n_estimators': 700, 'learning_rate': 0.02866862163647775, 'booster': 'gbtree', 'lambda': 0.06593420136948168, 'alpha': 0.09422032920286877, 'subsample': 0.8192618375528491, 'colsample_bytree': 0.7744108530894868, 'max_depth': 7, 'min_child_weight': 6, 'eta': 0.1709486311771137, 'gamma': 0.11561163955209758}. Best is trial 2 with value: -32.28275705456003.\n","/usr/local/lib/python3.10/dist-packages/optuna/distributions.py:700: UserWarning: The distribution is specified by [700, 2000] and step=500, but the range is not divisible by `step`. It will be replaced by [700, 1700].\n","  warnings.warn(\n","[I 2023-07-28 01:33:29,942] Trial 3 finished with value: -32.27704154569115 and parameters: {'n_estimators': 1700, 'learning_rate': 0.03843577595482299, 'booster': 'gbtree', 'lambda': 0.0195981522370281, 'alpha': 0.042490206948692426, 'subsample': 0.517530648513373, 'colsample_bytree': 0.5251882334344409, 'max_depth': 7, 'min_child_weight': 1, 'eta': 0.762729387178045, 'gamma': 0.029034752066997176}. Best is trial 3 with value: -32.27704154569115.\n","/usr/local/lib/python3.10/dist-packages/optuna/distributions.py:700: UserWarning: The distribution is specified by [700, 2000] and step=500, but the range is not divisible by `step`. It will be replaced by [700, 1700].\n","  warnings.warn(\n","[I 2023-07-28 01:34:59,076] Trial 4 finished with value: -32.28439535911695 and parameters: {'n_estimators': 700, 'learning_rate': 0.040039017598421774, 'booster': 'gbtree', 'lambda': 0.022785680797968836, 'alpha': 0.08702142692220825, 'subsample': 0.8142979053336068, 'colsample_bytree': 0.6300568011094719, 'max_depth': 9, 'min_child_weight': 10, 'eta': 0.16772175451037669, 'gamma': 0.6169189733670094}. Best is trial 3 with value: -32.27704154569115.\n","/usr/local/lib/python3.10/dist-packages/optuna/distributions.py:700: UserWarning: The distribution is specified by [700, 2000] and step=500, but the range is not divisible by `step`. It will be replaced by [700, 1700].\n","  warnings.warn(\n","[I 2023-07-28 01:38:28,601] Trial 5 finished with value: -32.31169621896129 and parameters: {'n_estimators': 1200, 'learning_rate': 0.033676802769105625, 'booster': 'gbtree', 'lambda': 0.05316205787199856, 'alpha': 0.019485135610553275, 'subsample': 0.8954841742361204, 'colsample_bytree': 0.7364754333950008, 'max_depth': 9, 'min_child_weight': 3, 'eta': 0.9015391569687883, 'gamma': 0.669413096563515}. Best is trial 3 with value: -32.27704154569115.\n","/usr/local/lib/python3.10/dist-packages/optuna/distributions.py:700: UserWarning: The distribution is specified by [700, 2000] and step=500, but the range is not divisible by `step`. It will be replaced by [700, 1700].\n","  warnings.warn(\n","[I 2023-07-28 01:43:27,015] Trial 6 finished with value: -32.315352278166216 and parameters: {'n_estimators': 1200, 'learning_rate': 0.03485906664612504, 'booster': 'gbtree', 'lambda': 0.07175900754750576, 'alpha': 0.06346241875054003, 'subsample': 0.5684258444887014, 'colsample_bytree': 0.7430943129745337, 'max_depth': 20, 'min_child_weight': 1, 'eta': 0.3812569329694699, 'gamma': 0.5229077022542582}. Best is trial 3 with value: -32.27704154569115.\n","/usr/local/lib/python3.10/dist-packages/optuna/distributions.py:700: UserWarning: The distribution is specified by [700, 2000] and step=500, but the range is not divisible by `step`. It will be replaced by [700, 1700].\n","  warnings.warn(\n","[I 2023-07-28 01:52:33,368] Trial 7 finished with value: -32.31004243641581 and parameters: {'n_estimators': 1700, 'learning_rate': 0.03524992493093535, 'booster': 'gbtree', 'lambda': 0.03893965896174042, 'alpha': 0.02663211393936357, 'subsample': 0.848463865862461, 'colsample_bytree': 0.8584512505367121, 'max_depth': 18, 'min_child_weight': 5, 'eta': 0.19135826382544463, 'gamma': 0.10908344848395754}. Best is trial 3 with value: -32.27704154569115.\n","/usr/local/lib/python3.10/dist-packages/optuna/distributions.py:700: UserWarning: The distribution is specified by [700, 2000] and step=500, but the range is not divisible by `step`. It will be replaced by [700, 1700].\n","  warnings.warn(\n","[I 2023-07-28 01:56:01,799] Trial 8 finished with value: -32.30392780020484 and parameters: {'n_estimators': 1200, 'learning_rate': 0.03169092541009727, 'booster': 'gbtree', 'lambda': 0.028171004461063655, 'alpha': 0.07975781150385318, 'subsample': 0.7962152134798687, 'colsample_bytree': 0.6836441758722107, 'max_depth': 10, 'min_child_weight': 10, 'eta': 0.7380200114938964, 'gamma': 0.3839652807949925}. Best is trial 3 with value: -32.27704154569115.\n","/usr/local/lib/python3.10/dist-packages/optuna/distributions.py:700: UserWarning: The distribution is specified by [700, 2000] and step=500, but the range is not divisible by `step`. It will be replaced by [700, 1700].\n","  warnings.warn(\n","[I 2023-07-28 02:02:46,090] Trial 9 finished with value: -32.314424939958066 and parameters: {'n_estimators': 1200, 'learning_rate': 0.04993352827293347, 'booster': 'gbtree', 'lambda': 0.084601385927234, 'alpha': 0.022599624926369362, 'subsample': 0.6524665441049411, 'colsample_bytree': 0.9637136044672514, 'max_depth': 18, 'min_child_weight': 9, 'eta': 0.2785114142446834, 'gamma': 0.5816164500995181}. Best is trial 3 with value: -32.27704154569115.\n"]},{"name":"stdout","output_type":"stream","text":["Best params: {'n_estimators': 1700, 'learning_rate': 0.03843577595482299, 'booster': 'gbtree', 'lambda': 0.0195981522370281, 'alpha': 0.042490206948692426, 'subsample': 0.517530648513373, 'colsample_bytree': 0.5251882334344409, 'max_depth': 7, 'min_child_weight': 1, 'eta': 0.762729387178045, 'gamma': 0.029034752066997176}\n","Best value: -32.27704154569115\n","Mean squared 32.27704154569115\n"]},{"ename":"AttributeError","evalue":"ignored","output_type":"error","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mAttributeError\u001b[0m                            Traceback (most recent call last)","\u001b[0;32m\u003cipython-input-164-457f61bc08bf\u003e\u001b[0m in \u001b[0;36m\u003ccell line: 58\u003e\u001b[0;34m()\u001b[0m\n\u001b[1;32m     56\u001b[0m \u001b[0mprint\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\"Mean squared\"\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0mmean\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     57\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---\u003e 58\u001b[0;31m \u001b[0mpredXgboost\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mmodel\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mpredict_proba\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mtest\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;36m1\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m","\u001b[0;31mAttributeError\u001b[0m: 'XGBRegressor' object has no attribute 'predict_proba'"]}],"source":["import xgboost as xgb\n","from sklearn.metrics import mean_squared_error\n","from sklearn.model_selection import StratifiedKFold, KFold\n","\n","def objective(trial):\n","    params = {\n","        'n_estimators': trial.suggest_int('n_estimators', 700, 2000, step=500),\n","        'learning_rate': trial.suggest_float('learning_rate', 0.01, 0.05),\n","        'booster': trial.suggest_categorical('booster', ['gbtree']),\n","        'lambda': trial.suggest_float('lambda', 1e-8, 0.1),\n","        'alpha': trial.suggest_float('alpha', 1e-8, 0.1),\n","        'subsample': trial.suggest_float('subsample', 0.5, 1.0),\n","        'colsample_bytree': trial.suggest_float('colsample_bytree', 0.5, 1.0),\n","        'max_depth': trial.suggest_int('max_depth', 3, 20),\n","        'min_child_weight': trial.suggest_int('min_child_weight', 1, 14),\n","        'eta': trial.suggest_float('eta', 1e-8, 1.0),\n","        'gamma': trial.suggest_float('gamma', 1e-8, 1.0),\n","    }\n","\n","    model = xgb.XGBRegressor(**params, random_state=42)\n","    skf = StratifiedKFold(n_splits=5, shuffle=True, random_state=42)\n","    scores = []\n","    for train_index, val_index in skf.split(x_train, y_train):\n","        X_train_fold, X_val_fold = x_train.iloc[train_index], x_train.iloc[val_index]\n","        y_train_fold, y_val_fold = y_train.iloc[train_index], y_train.iloc[val_index]\n","\n","        model.fit(X_train_fold, y_train_fold)\n","        y_val_pred = model.predict(X_val_fold)\n","        score = mean_squared_error(y_val_fold, y_val_pred)\n","        scores.append(score)\n","\n","    mean = sum(scores) / len(scores)\n","\n","    return -mean\n","\n","study = optuna.create_study(direction='maximize')\n","study.optimize(objective, n_trials=10)\n","\n","best_params = study.best_params\n","best_value = study.best_value\n","print(f\"Best params: {best_params}\")\n","print(f\"Best value: {best_value}\")"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":179788,"status":"ok","timestamp":1690510513704,"user":{"displayName":"Musa Muhammad","userId":"05399772858105698249"},"user_tz":-60},"id":"HwPQmWLhQQ_i","outputId":"1da3dd7e-e23c-4df3-aed4-01d3212b0d94"},"outputs":[{"name":"stdout","output_type":"stream","text":["Mean squared 32.27704154569115\n"]}],"source":["model = xgb.XGBRegressor(**best_params, random_state=42)\n","skf = StratifiedKFold(n_splits=5, shuffle=True, random_state=42)\n","scores = []\n","for train_index, val_index in skf.split(x_train, y_train):\n","  X_train_fold, X_val_fold = x_train.iloc[train_index], x_train.iloc[val_index]\n","  y_train_fold, y_val_fold = y_train.iloc[train_index], y_train.iloc[val_index]\n","\n","  model.fit(X_train_fold, y_train_fold)\n","  y_val_pred = model.predict(X_val_fold)\n","  score = mean_squared_error(y_val_fold, y_val_pred)\n","  scores.append(score)\n","mean = sum(scores) / len(scores)\n","print(\"Mean squared\",mean)\n","\n","predXgboost = model.predict(test)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"PXgCiueYw5GP"},"outputs":[],"source":["sam = pd.read_csv(\"/content/SampleSubmission (19).csv\")\n","test = pd.read_csv(\"/content/Test (20).csv\")"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"bgDBynHMvPc9"},"outputs":[],"source":["submission = pd.DataFrame({'ride_id': test[\"ride_id\"], 'number_of_ticket': test_pred})\n","submission.to_csv('submit pred 3.csv', index=False)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"z5eGf5iIxcqU"},"outputs":[],"source":[]}],"metadata":{"colab":{"authorship_tag":"ABX9TyOsIb0UVd2lmaATVDDquKUL","name":"","version":""},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}